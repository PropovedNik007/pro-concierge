var je=Object.defineProperty;var de=r=>{throw TypeError(r)};var We=(r,t,e)=>t in r?je(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var d=(r,t,e)=>We(r,typeof t!="symbol"?t+"":t,e),fe=(r,t,e)=>t.has(r)||de("Cannot "+e);var yt=(r,t,e)=>(fe(r,t,"read from private field"),e?e.call(r):t.get(r)),kt=(r,t,e)=>t.has(r)?de("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),zt=(r,t,e,i)=>(fe(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e);import{a as et,t as nt}from"../chunks/disclose-version.D4yGIf47.js";import{i as Fe}from"../chunks/legacy.CT_svfx6.js";import{p as Ve,f as me,a as Ke,b as At,s as G,g as w,m as pe,c as Z,r as z,t as Et,ak as St}from"../chunks/runtime.Cqpx5nLn.js";import{a as It}from"../chunks/store.DmgX54Oa.js";import{o as qe,i as ye}from"../chunks/index-client.CzUS1NVV.js";import{e as Ut,i as Ht,s as Je}from"../chunks/class.DPkg1QDy.js";import{r as Ze,a as Xe,b as _e}from"../chunks/auth.M5j1s9aF.js";import{e as wt}from"../chunks/utils.BORTP5RR.js";import{b as Ge}from"../chunks/input.DAzLp6Wi.js";import{N as $e,a as Qe}from"../chunks/NavBrand.CFnHIN77.js";class Gt{constructor(t){d(this,"icaltype","binary");this.value=t}static fromString(t){return new Gt(t)}decodeValue(){return this._b64_decode(this.value)}setEncodedValue(t){this.value=this._b64_encode(t)}_b64_encode(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i,s,n,a,l,o,u,h,c=0,f=0,y="",A=[];if(!t)return t;do i=t.charCodeAt(c++),s=t.charCodeAt(c++),n=t.charCodeAt(c++),h=i<<16|s<<8|n,a=h>>18&63,l=h>>12&63,o=h>>6&63,u=h&63,A[f++]=e.charAt(a)+e.charAt(l)+e.charAt(o)+e.charAt(u);while(c<t.length);y=A.join("");let p=t.length%3;return(p?y.slice(0,p-3):y)+"===".slice(p||3)}_b64_decode(t){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i,s,n,a,l,o,u,h,c=0,f=0,y="",A=[];if(!t)return t;t+="";do a=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),o=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),h=a<<18|l<<12|o<<6|u,i=h>>16&255,s=h>>8&255,n=h&255,o==64?A[f++]=String.fromCharCode(i):u==64?A[f++]=String.fromCharCode(i,s):A[f++]=String.fromCharCode(i,s,n);while(c<t.length);return y=A.join(""),y}toString(){return this.value}}const ti=/([PDWHMTS]{1,1})/,ei=["weeks","days","hours","minutes","seconds","isNegative"];class W{constructor(t){d(this,"weeks",0);d(this,"days",0);d(this,"hours",0);d(this,"minutes",0);d(this,"seconds",0);d(this,"isNegative",!1);d(this,"icalclass","icalduration");d(this,"icaltype","duration");this.wrappedJSObject=this,this.fromData(t)}static fromSeconds(t){return new W().fromSeconds(t)}static isValueString(t){return t[0]==="P"||t[1]==="P"}static fromString(t){let e=0,i=Object.create(null),s=0;for(;(e=t.search(ti))!==-1;){let n=t[e],a=t.slice(0,Math.max(0,e));t=t.slice(e+1),s+=ii(n,a,i)}if(s<2)throw new Error('invalid duration value: Not enough duration components in "'+t+'"');return new W(i)}static fromData(t){return new W(t)}clone(){return W.fromData(this)}toSeconds(){let t=this.seconds+60*this.minutes+3600*this.hours+86400*this.days+604800*this.weeks;return this.isNegative?-t:t}fromSeconds(t){let e=Math.abs(t);return this.isNegative=t<0,this.days=P(e/86400),this.days%7==0?(this.weeks=this.days/7,this.days=0):this.weeks=0,e-=(this.days+7*this.weeks)*86400,this.hours=P(e/3600),e-=this.hours*3600,this.minutes=P(e/60),e-=this.minutes*60,this.seconds=e,this}fromData(t){for(let e of ei)t&&e in t?this[e]=t[e]:this[e]=0}reset(){this.isNegative=!1,this.weeks=0,this.days=0,this.hours=0,this.minutes=0,this.seconds=0}compare(t){let e=this.toSeconds(),i=t.toSeconds();return(e>i)-(e<i)}normalize(){this.fromSeconds(this.toSeconds())}toString(){if(this.toSeconds()==0)return"PT0S";{let t="";return this.isNegative&&(t+="-"),t+="P",this.weeks&&(t+=this.weeks+"W"),this.days&&(t+=this.days+"D"),(this.hours||this.minutes||this.seconds)&&(t+="T",this.hours&&(t+=this.hours+"H"),this.minutes&&(t+=this.minutes+"M"),this.seconds&&(t+=this.seconds+"S")),t}}toICALString(){return this.toString()}}function ii(r,t,e){let i;switch(r){case"P":t&&t==="-"?e.isNegative=!0:e.isNegative=!1;break;case"D":i="days";break;case"W":i="weeks";break;case"H":i="hours";break;case"M":i="minutes";break;case"S":i="seconds";break;default:return 0}if(i){if(!t&&t!==0)throw new Error('invalid duration value: Missing number before "'+r+'"');let s=parseInt(t,10);if(Mt(s))throw new Error('invalid duration value: Invalid number "'+t+'" before "'+r+'"');e[i]=s}return 1}var vt;const m=class m{constructor(t,e){d(this,"icalclass","icaltime");d(this,"_cachedUnixTime",null);d(this,"zone",null);d(this,"_pendingNormalization",!1);this.wrappedJSObject=this;let i=this._time=Object.create(null);i.year=0,i.month=1,i.day=1,i.hour=0,i.minute=0,i.second=0,i.isDate=!1,this.fromData(t,e)}static daysInMonth(t,e){let i=[0,31,28,31,30,31,30,31,31,30,31,30,31],s=30;return t<1||t>12||(s=i[t],t==2&&(s+=m.isLeapYear(e))),s}static isLeapYear(t){return t<=1752?t%4==0:t%4==0&&t%100!=0||t%400==0}static fromDayOfYear(t,e){let i=e,s=t,n=new m;n.auto_normalize=!1;let a=m.isLeapYear(i)?1:0;if(s<1)return i--,a=m.isLeapYear(i)?1:0,s+=m.daysInYearPassedMonth[a][12],m.fromDayOfYear(s,i);if(s>m.daysInYearPassedMonth[a][12])return a=m.isLeapYear(i)?1:0,s-=m.daysInYearPassedMonth[a][12],i++,m.fromDayOfYear(s,i);n.year=i,n.isDate=!0;for(let l=11;l>=0;l--)if(s>m.daysInYearPassedMonth[a][l]){n.month=l+1,n.day=s-m.daysInYearPassedMonth[a][l];break}return n.auto_normalize=!0,n}static fromStringv2(t){return new m({year:parseInt(t.slice(0,4),10),month:parseInt(t.slice(5,7),10),day:parseInt(t.slice(8,10),10),isDate:!0})}static fromDateString(t){return new m({year:R(t.slice(0,4)),month:R(t.slice(5,7)),day:R(t.slice(8,10)),isDate:!0})}static fromDateTimeString(t,e){if(t.length<19)throw new Error('invalid date-time value: "'+t+'"');let i,s;t[19]&&t[19]==="Z"?i=I.utcTimezone:e&&(s=e.getParameter("tzid"),e.parent&&(e.parent.name==="standard"||e.parent.name==="daylight"?i=I.localTimezone:s&&(i=e.parent.getTimeZoneByID(s))));const n={year:R(t.slice(0,4)),month:R(t.slice(5,7)),day:R(t.slice(8,10)),hour:R(t.slice(11,13)),minute:R(t.slice(14,16)),second:R(t.slice(17,19))};return s&&!i&&(n.timezone=s),new m(n,i)}static fromString(t,e){return t.length>10?m.fromDateTimeString(t,e):m.fromDateString(t)}static fromJSDate(t,e){return new m().fromJSDate(t,e)}static now(){return m.fromJSDate(new Date,!1)}static weekOneStarts(t,e){let i=m.fromData({year:t,month:1,day:1,isDate:!0}),s=i.dayOfWeek(),n=e||m.DEFAULT_WEEK_START;return s>m.THURSDAY&&(i.day+=7),n>m.THURSDAY&&(i.day-=7),i.day-=s-n,i}static getDominicalLetter(t){let e="GFEDCBA",i=(t+(t/4|0)+(t/400|0)-(t/100|0)-1)%7;return m.isLeapYear(t)?e[(i+6)%7]+e[i]:e[i]}static get epochTime(){return yt(this,vt)||zt(this,vt,m.fromData({year:1970,month:1,day:1,hour:0,minute:0,second:0,isDate:!1,timezone:"Z"})),yt(this,vt)}static _cmp_attr(t,e,i){return t[i]>e[i]?1:t[i]<e[i]?-1:0}get icaltype(){return this.isDate?"date":"date-time"}clone(){return new m(this._time,this.zone)}reset(){this.fromData(m.epochTime),this.zone=I.utcTimezone}resetTo(t,e,i,s,n,a,l){this.fromData({year:t,month:e,day:i,hour:s,minute:n,second:a,zone:l})}fromJSDate(t,e){return t?e?(this.zone=I.utcTimezone,this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()):(this.zone=I.localTimezone,this.year=t.getFullYear(),this.month=t.getMonth()+1,this.day=t.getDate(),this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds()):this.reset(),this._cachedUnixTime=null,this}fromData(t,e){if(t)for(let[i,s]of Object.entries(t))i!=="icaltype"&&(this[i]=s);if(e&&(this.zone=e),t&&!("isDate"in t)?this.isDate=!("hour"in t):t&&"isDate"in t&&(this.isDate=t.isDate),t&&"timezone"in t){let i=Jt.get(t.timezone);this.zone=i||I.localTimezone}return t&&"zone"in t&&(this.zone=t.zone),this.zone||(this.zone=I.localTimezone),this._cachedUnixTime=null,this}dayOfWeek(t){let e=t||m.SUNDAY,i=(this.year<<12)+(this.month<<8)+(this.day<<3)+e;if(i in m._dowCache)return m._dowCache[i];let s=this.day,n=this.month+(this.month<3?12:0),a=this.year-(this.month<3?1:0),l=s+a+P((n+1)*26/10)+P(a/4);return l+=P(a/100)*6+P(a/400),l=(l+7-e)%7+1,m._dowCache[i]=l,l}dayOfYear(){let t=m.isLeapYear(this.year)?1:0;return m.daysInYearPassedMonth[t][this.month-1]+this.day}startOfWeek(t){let e=t||m.SUNDAY,i=this.clone();return i.day-=(this.dayOfWeek()+7-e)%7,i.isDate=!0,i.hour=0,i.minute=0,i.second=0,i}endOfWeek(t){let e=t||m.SUNDAY,i=this.clone();return i.day+=(7-this.dayOfWeek()+e-m.SUNDAY)%7,i.isDate=!0,i.hour=0,i.minute=0,i.second=0,i}startOfMonth(){let t=this.clone();return t.day=1,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}endOfMonth(){let t=this.clone();return t.day=m.daysInMonth(t.month,t.year),t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}startOfYear(){let t=this.clone();return t.day=1,t.month=1,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}endOfYear(){let t=this.clone();return t.day=31,t.month=12,t.isDate=!0,t.hour=0,t.minute=0,t.second=0,t}startDoyWeek(t){let e=t||m.SUNDAY,i=this.dayOfWeek()-e;return i<0&&(i+=7),this.dayOfYear()-i}getDominicalLetter(){return m.getDominicalLetter(this.year)}nthWeekDay(t,e){let i=m.daysInMonth(this.month,this.year),s,n=e,a=0,l=this.clone();if(n>=0){l.day=1,n!=0&&n--,a=l.day;let o=l.dayOfWeek(),u=t-o;u<0&&(u+=7),a+=u,a-=t,s=t}else{l.day=i;let o=l.dayOfWeek();n++,s=o-t,s<0&&(s+=7),s=i-s}return s+=n*7,a+s}isNthWeekDay(t,e){let i=this.dayOfWeek();return e===0&&i===t||this.nthWeekDay(t,e)===this.day}weekNumber(t){let e=(this.year<<12)+(this.month<<8)+(this.day<<3)+t;if(e in m._wnCache)return m._wnCache[e];let i,s=this.clone();s.isDate=!0;let n=this.year;s.month==12&&s.day>25?(i=m.weekOneStarts(n+1,t),s.compare(i)<0?i=m.weekOneStarts(n,t):n++):(i=m.weekOneStarts(n,t),s.compare(i)<0&&(i=m.weekOneStarts(--n,t)));let a=s.subtractDate(i).toSeconds()/86400,l=P(a/7)+1;return m._wnCache[e]=l,l}addDuration(t){let e=t.isNegative?-1:1,i=this.second,s=this.minute,n=this.hour,a=this.day;i+=e*t.seconds,s+=e*t.minutes,n+=e*t.hours,a+=e*t.days,a+=e*7*t.weeks,this.second=i,this.minute=s,this.hour=n,this.day=a,this._cachedUnixTime=null}subtractDate(t){let e=this.toUnixTime()+this.utcOffset(),i=t.toUnixTime()+t.utcOffset();return W.fromSeconds(e-i)}subtractDateTz(t){let e=this.toUnixTime(),i=t.toUnixTime();return W.fromSeconds(e-i)}compare(t){let e=this.toUnixTime(),i=t.toUnixTime();return e>i?1:i>e?-1:0}compareDateOnlyTz(t,e){let i=this.convertToZone(e),s=t.convertToZone(e),n=0;return(n=m._cmp_attr(i,s,"year"))!=0||(n=m._cmp_attr(i,s,"month"))!=0||(n=m._cmp_attr(i,s,"day"))!=0,n}convertToZone(t){let e=this.clone(),i=this.zone.tzid==t.tzid;return!this.isDate&&!i&&I.convert_time(e,this.zone,t),e.zone=t,e}utcOffset(){return this.zone==I.localTimezone||this.zone==I.utcTimezone?0:this.zone.utcOffset(this)}toICALString(){let t=this.toString();return t.length>10?k.icalendar.value["date-time"].toICAL(t):k.icalendar.value.date.toICAL(t)}toString(){let t=this.year+"-"+J(this.month)+"-"+J(this.day);return this.isDate||(t+="T"+J(this.hour)+":"+J(this.minute)+":"+J(this.second),this.zone===I.utcTimezone&&(t+="Z")),t}toJSDate(){return this.zone==I.localTimezone?this.isDate?new Date(this.year,this.month-1,this.day):new Date(this.year,this.month-1,this.day,this.hour,this.minute,this.second,0):new Date(this.toUnixTime()*1e3)}_normalize(){return this._time.isDate&&(this._time.hour=0,this._time.minute=0,this._time.second=0),this.adjust(0,0,0,0),this}adjust(t,e,i,s,n){let a,l,o=0,u=0,h,c,f,y,A,p=n||this._time;if(p.isDate||(h=p.second+s,p.second=h%60,a=P(h/60),p.second<0&&(p.second+=60,a--),c=p.minute+i+a,p.minute=c%60,l=P(c/60),p.minute<0&&(p.minute+=60,l--),f=p.hour+e+l,p.hour=f%24,o=P(f/24),p.hour<0&&(p.hour+=24,o--)),p.month>12?u=P((p.month-1)/12):p.month<1&&(u=P(p.month/12)-1),p.year+=u,p.month-=12*u,y=p.day+t+o,y>0)for(;A=m.daysInMonth(p.month,p.year),!(y<=A);)p.month++,p.month>12&&(p.year++,p.month=1),y-=A;else for(;y<=0;)p.month==1?(p.year--,p.month=12):p.month--,y+=m.daysInMonth(p.month,p.year);return p.day=y,this._cachedUnixTime=null,this}fromUnixTime(t){this.zone=I.utcTimezone;let e=new Date(t*1e3);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this._time.isDate?(this.hour=0,this.minute=0,this.second=0):(this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()),this._cachedUnixTime=null}toUnixTime(){if(this._cachedUnixTime!==null)return this._cachedUnixTime;let t=this.utcOffset(),e=Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second-t);return this._cachedUnixTime=e/1e3,this._cachedUnixTime}toJSON(){let t=["year","month","day","hour","minute","second","isDate"],e=Object.create(null),i=0,s=t.length,n;for(;i<s;i++)n=t[i],e[n]=this[n];return this.zone&&(e.timezone=this.zone.tzid),e}};vt=new WeakMap,d(m,"_dowCache",{}),d(m,"_wnCache",{}),d(m,"fromData",function(e,i){return new m().fromData(e,i)}),kt(m,vt,null),d(m,"daysInYearPassedMonth",[[0,31,59,90,120,151,181,212,243,273,304,334,365],[0,31,60,91,121,152,182,213,244,274,305,335,366]]),d(m,"SUNDAY",1),d(m,"MONDAY",2),d(m,"TUESDAY",3),d(m,"WEDNESDAY",4),d(m,"THURSDAY",5),d(m,"FRIDAY",6),d(m,"SATURDAY",7),d(m,"DEFAULT_WEEK_START",2);let g=m;(function(){function t(e){Object.defineProperty(g.prototype,e,{get:function(){return this._pendingNormalization&&(this._normalize(),this._pendingNormalization=!1),this._time[e]},set:function(s){e==="isDate"&&s&&!this._time.isDate&&this.adjust(0,0,0,0),this._cachedUnixTime=null,this._pendingNormalization=!0,this._time[e]=s}})}t("year"),t("month"),t("day"),t("hour"),t("minute"),t("second"),t("isDate")})();const ri=/[^ \t]/,qt=":",ne=";",si="=",ni="unknown",ai="text",li={"^'":'"',"^n":`
`,"^^":"^"};function N(r){let t={},e=t.component=[];if(t.stack=[e],N._eachLine(r,function(i,s){N._handleContentLine(s,t)}),t.stack.length>1)throw new _t("invalid ical body. component began but did not end");return t=null,e.length==1?e[0]:e}N.property=function(r,t){let e={component:[[],[]],designSet:t||k.defaultSet};return N._handleContentLine(r,e),e.component[1][0]};N.component=function(r){return N(r)};class _t extends Error{constructor(){super(...arguments);d(this,"name",this.constructor.name)}}N.ParserError=_t;N._handleContentLine=function(r,t){let e=r.indexOf(qt),i=r.indexOf(ne),s,n,a,l,o={};i!==-1&&e!==-1&&i>e&&(i=-1);let u;if(i!==-1){if(a=r.slice(0,Math.max(0,i)).toLowerCase(),u=N._parseParameters(r.slice(Math.max(0,i)),0,t.designSet),u[2]==-1)throw new _t("Invalid parameters in '"+r+"'");if(o=u[0],s=u[1].length+u[2]+i,(n=r.slice(Math.max(0,s)).indexOf(qt))!==-1)l=r.slice(Math.max(0,s+n+1));else throw new _t("Missing parameter value in '"+r+"'")}else if(e!==-1){if(a=r.slice(0,Math.max(0,e)).toLowerCase(),l=r.slice(Math.max(0,e+1)),a==="begin"){let S=[l.toLowerCase(),[],[]];t.stack.length===1?t.component.push(S):t.component[2].push(S),t.stack.push(t.component),t.component=S,t.designSet||(t.designSet=k.getDesignSet(t.component[0]));return}else if(a==="end"){t.component=t.stack.pop();return}}else throw new _t('invalid line (no token ";" or ":") "'+r+'"');let h,c=!1,f=!1,y,A,p;t.designSet.propertyGroups&&a.indexOf(".")!==-1?(A=a.split("."),o.group=A[0],p=A[1]):p=a,p in t.designSet.property&&(y=t.designSet.property[p],"multiValue"in y&&(c=y.multiValue),"structuredValue"in y&&(f=y.structuredValue),l&&"detectType"in y&&(h=y.detectType(l))),h||("value"in o?h=o.value.toLowerCase():y?h=y.defaultType:h=ni),delete o.value;let T;c&&f?(l=N._parseMultiValue(l,f,h,[],c,t.designSet,f),T=[p,o,h,l]):c?(T=[p,o,h],N._parseMultiValue(l,c,h,T,null,t.designSet,!1)):f?(l=N._parseMultiValue(l,f,h,[],null,t.designSet,f),T=[p,o,h,l]):(l=N._parseValue(l,h,t.designSet,!1),T=[p,o,h,l]),t.component[0]==="vcard"&&t.component[1].length===0&&!(a==="version"&&l==="4.0")&&(t.designSet=k.getDesignSet("vcard3")),t.component[1].push(T)};N._parseValue=function(r,t,e,i){return t in e.value&&"fromICAL"in e.value[t]?e.value[t].fromICAL(r,i):r};N._parseParameters=function(r,t,e){let i=t,s=0,n=si,a={},l,o,u,h=-1,c,f,y;for(;s!==!1&&(s=r.indexOf(n,s+1))!==-1;){if(l=r.slice(i+1,s),l.length==0)throw new _t("Empty parameter name in '"+r+"'");if(o=l.toLowerCase(),y=!1,f=!1,o in e.param&&e.param[o].valueType?c=e.param[o].valueType:c=ai,o in e.param&&(f=e.param[o].multiValue,e.param[o].multiValueSeparateDQuote&&(y=N._rfc6868Escape('"'+f+'"'))),r[s+1]==='"'){if(h=s+2,s=r.indexOf('"',h),f&&s!=-1){let S=!0;for(;S;)r[s+1]==f&&r[s+2]=='"'?s=r.indexOf('"',s+3):S=!1}if(s===-1)throw new _t('invalid line (no matching double quote) "'+r+'"');u=r.slice(h,s),i=r.indexOf(ne,s);let T=r.indexOf(qt,s);(i===-1||T!==-1&&i>T)&&(s=!1)}else{h=s+1;let T=r.indexOf(ne,h),S=r.indexOf(qt,h);S!==-1&&T>S?(T=S,s=!1):T===-1?(S===-1?T=r.length:T=S,s=!1):(i=T,s=T),u=r.slice(h,T)}const p=u.length;if(u=N._rfc6868Escape(u),h+=p-u.length,f){let T=y||f;u=N._parseMultiValue(u,T,c,[],null,e)}else u=N._parseValue(u,c,e);f&&o in a?Array.isArray(a[o])?a[o].push(u):a[o]=[a[o],u]:a[o]=u}return[a,u,h]};N._rfc6868Escape=function(r){return r.replace(/\^['n^]/g,function(t){return li[t]})};N._parseMultiValue=function(r,t,e,i,s,n,a){let l=0,o=0,u;if(t.length===0)return r;for(;(l=Se(r,t,o))!==-1;)u=r.slice(o,l),s?u=N._parseMultiValue(u,s,e,[],null,n,a):u=N._parseValue(u,e,n,a),i.push(u),o=l+t.length;return u=r.slice(o),s?u=N._parseMultiValue(u,s,e,[],null,n,a):u=N._parseValue(u,e,n,a),i.push(u),i.length==1?i[0]:i};N._eachLine=function(r,t){let e=r.length,i=r.search(ri),s=i,n,a,l;do s=r.indexOf(`
`,i)+1,s>1&&r[s-2]==="\r"?l=2:l=1,s===0&&(s=e,l=0),a=r[i],a===" "||a==="	"?n+=r.slice(i+1,s-l):(n&&t(null,n),n=r.slice(i,s-l)),i=s;while(s!==e);n=n.trim(),n.length&&t(null,n)};const oi=["tzid","location","tznames","latitude","longitude"];var bt,xt;const O=class O{constructor(t){d(this,"tzid","");d(this,"location","");d(this,"tznames","");d(this,"latitude",0);d(this,"longitude",0);d(this,"component",null);d(this,"expandedUntilYear",0);d(this,"icalclass","icaltimezone");this.wrappedJSObject=this,this.fromData(t)}static _compare_change_fn(t,e){return t.year<e.year?-1:t.year>e.year?1:t.month<e.month?-1:t.month>e.month?1:t.day<e.day?-1:t.day>e.day?1:t.hour<e.hour?-1:t.hour>e.hour?1:t.minute<e.minute?-1:t.minute>e.minute?1:t.second<e.second?-1:t.second>e.second?1:0}static convert_time(t,e,i){if(t.isDate||e.tzid==i.tzid||e==O.localTimezone||i==O.localTimezone)return t.zone=i,t;let s=e.utcOffset(t);return t.adjust(0,0,0,-s),s=i.utcOffset(t),t.adjust(0,0,0,s),null}static fromData(t){return new O().fromData(t)}static get utcTimezone(){return yt(this,bt)||zt(this,bt,O.fromData({tzid:"UTC"})),yt(this,bt)}static get localTimezone(){return yt(this,xt)||zt(this,xt,O.fromData({tzid:"floating"})),yt(this,xt)}static adjust_change(t,e,i,s,n){return g.prototype.adjust.call(t,e,i,s,n,t)}fromData(t){if(this.expandedUntilYear=0,this.changes=[],t instanceof X)this.component=t;else{if(t&&"component"in t)if(typeof t.component=="string"){let e=N(t.component);this.component=new X(e)}else t.component instanceof X?this.component=t.component:this.component=null;for(let e of oi)t&&e in t&&(this[e]=t[e])}return this.component instanceof X&&!this.tzid&&(this.tzid=this.component.getFirstPropertyValue("tzid")),this}utcOffset(t){if(this==O.utcTimezone||this==O.localTimezone||(this._ensureCoverage(t.year),!this.changes.length))return 0;let e={year:t.year,month:t.month,day:t.day,hour:t.hour,minute:t.minute,second:t.second},i=this._findNearbyChange(e),s=-1,n=1;for(;;){let o=Tt(this.changes[i],!0);if(o.utcOffset<o.prevUtcOffset?O.adjust_change(o,0,0,0,o.utcOffset):O.adjust_change(o,0,0,0,o.prevUtcOffset),O._compare_change_fn(e,o)>=0?s=i:n=-1,n==-1&&s!=-1)break;if(i+=n,i<0)return 0;if(i>=this.changes.length)break}let a=this.changes[s];if(a.utcOffset-a.prevUtcOffset<0&&s>0){let o=Tt(a,!0);if(O.adjust_change(o,0,0,0,o.prevUtcOffset),O._compare_change_fn(e,o)<0){let u=this.changes[s-1],h=!1;a.is_daylight!=h&&u.is_daylight==h&&(a=u)}}return a.utcOffset}_findNearbyChange(t){let e=gt(this.changes,t,O._compare_change_fn);return e>=this.changes.length?this.changes.length-1:e}_ensureCoverage(t){if(O._minimumExpansionYear==-1){let i=g.now();O._minimumExpansionYear=i.year}let e=t;if(e<O._minimumExpansionYear&&(e=O._minimumExpansionYear),e+=O.EXTRA_COVERAGE,!this.changes.length||this.expandedUntilYear<t){let i=this.component.getAllSubcomponents(),s=i.length,n=0;for(;n<s;n++)this._expandComponent(i[n],e,this.changes);this.changes.sort(O._compare_change_fn),this.expandedUntilYear=e}}_expandComponent(t,e,i){if(!t.hasProperty("dtstart")||!t.hasProperty("tzoffsetto")||!t.hasProperty("tzoffsetfrom"))return null;let s=t.getFirstProperty("dtstart").getFirstValue(),n;function a(o){return o.factor*(o.hours*3600+o.minutes*60)}function l(){let o={};return o.is_daylight=t.name=="daylight",o.utcOffset=a(t.getFirstProperty("tzoffsetto").getFirstValue()),o.prevUtcOffset=a(t.getFirstProperty("tzoffsetfrom").getFirstValue()),o}if(!t.hasProperty("rrule")&&!t.hasProperty("rdate"))n=l(),n.year=s.year,n.month=s.month,n.day=s.day,n.hour=s.hour,n.minute=s.minute,n.second=s.second,O.adjust_change(n,0,0,0,-n.prevUtcOffset),i.push(n);else{let o=t.getAllProperties("rdate");for(let h of o){let c=h.getFirstValue();n=l(),n.year=c.year,n.month=c.month,n.day=c.day,c.isDate?(n.hour=s.hour,n.minute=s.minute,n.second=s.second,s.zone!=O.utcTimezone&&O.adjust_change(n,0,0,0,-n.prevUtcOffset)):(n.hour=c.hour,n.minute=c.minute,n.second=c.second,c.zone!=O.utcTimezone&&O.adjust_change(n,0,0,0,-n.prevUtcOffset)),i.push(n)}let u=t.getFirstProperty("rrule");if(u){u=u.getFirstValue(),n=l(),u.until&&u.until.zone==O.utcTimezone&&(u.until.adjust(0,0,0,n.prevUtcOffset),u.until.zone=O.localTimezone);let h=u.iterator(s),c;for(;(c=h.next())&&(n=l(),!(c.year>e||!c));)n.year=c.year,n.month=c.month,n.day=c.day,n.hour=c.hour,n.minute=c.minute,n.second=c.second,n.isDate=c.isDate,O.adjust_change(n,0,0,0,-n.prevUtcOffset),i.push(n)}}return i}toString(){return this.tznames?this.tznames:this.tzid}};bt=new WeakMap,xt=new WeakMap,kt(O,bt,null),kt(O,xt,null),d(O,"_minimumExpansionYear",-1),d(O,"EXTRA_COVERAGE",5);let I=O,V=null;const Jt={get count(){return V===null?0:Object.keys(V).length},reset:function(){V=Object.create(null);let r=I.utcTimezone;V.Z=r,V.UTC=r,V.GMT=r},_hard_reset:function(){V=null},has:function(r){return V===null?!1:!!V[r]},get:function(r){return V===null&&this.reset(),V[r]},register:function(r,t){if(V===null&&this.reset(),typeof r=="string"&&t instanceof I&&([r,t]=[t,r]),t||(r instanceof I?t=r.tzid:r.name==="vtimezone"&&(r=new I(r),t=r.tzid)),!t)throw new TypeError("Neither a timezone nor a name was passed");if(r instanceof I)V[t]=r;else throw new TypeError("timezone must be ICAL.Timezone or ICAL.Component")},remove:function(r){return V===null?null:delete V[r]}};function ui(r){let t,e,i,s,n;if(!r||r.name!=="vcalendar")return r;for(t=r.getAllSubcomponents(),e=[],i={},n=0;n<t.length;n++)if(t[n].name==="vtimezone"){let a=t[n].getFirstProperty("tzid").getFirstValue();i[a]=t[n]}else e=e.concat(t[n].getAllProperties());for(s={},n=0;n<e.length;n++){let a=e[n].getParameter("tzid");a&&(s[a]=!0)}for(let[a,l]of Object.entries(i))s[a]||r.removeSubcomponent(l);for(let a of Object.keys(s))!i[a]&&Jt.has(a)&&r.addSubcomponent(Jt.get(a).component);return r}function Mt(r){return typeof r=="number"&&isNaN(r)}function R(r){let t=parseInt(r,10);if(Mt(t))throw new Error('Could not extract integer from "'+r+'"');return t}function st(r,t){if(!(typeof r>"u"))return r instanceof t?r:new t(r)}function Se(r,t,e){for(;(e=r.indexOf(t,e))!==-1;)if(e>0&&r[e-1]==="\\")e+=1;else return e;return-1}function gt(r,t,e){if(!r.length)return 0;let i=0,s=r.length-1,n,a;for(;i<=s;)if(n=i+Math.floor((s-i)/2),a=e(t,r[n]),a<0)s=n-1;else if(a>0)i=n+1;else break;return a<0?n:a>0?n+1:n}function Tt(r,t){if(!r||typeof r!="object")return r;if(r instanceof Date)return new Date(r.getTime());if("clone"in r)return r.clone();if(Array.isArray(r)){let e=[];for(let i=0;i<r.length;i++)e.push(t?Tt(r[i],!0):r[i]);return e}else{let e={};for(let[i,s]of Object.entries(r))t?e[i]=Tt(s,!0):e[i]=s;return e}}function Ie(r){let t="",e=r||"",i=0,s=0;for(;e.length;){let n=e.codePointAt(i);n<128?++s:n<2048?s+=2:n<65536?s+=3:s+=4,s<mt.foldLength+1?i+=n>65535?2:1:(t+=mt.newLineChar+" "+e.slice(0,Math.max(0,i)),e=e.slice(Math.max(0,i)),i=s=0)}return t.slice(mt.newLineChar.length+1)}function J(r){switch(typeof r!="string"&&(typeof r=="number"&&(r=parseInt(r)),r=String(r)),r.length){case 0:return"00";case 1:return"0"+r;default:return r}}function P(r){return r<0?Math.ceil(r):Math.floor(r)}function Yt(r,t){for(let e in r){let i=Object.getOwnPropertyDescriptor(r,e);i&&!Object.getOwnPropertyDescriptor(t,e)&&Object.defineProperty(t,e,i)}return t}var hi=Object.freeze({__proto__:null,updateTimezones:ui,isStrictlyNaN:Mt,strictParseInt:R,formatClassType:st,unescapedIndexOf:Se,binsearchInsert:gt,clone:Tt,foldline:Ie,pad2:J,trunc:P,extend:Yt});class Q{constructor(t){d(this,"hours",0);d(this,"minutes",0);d(this,"factor",1);d(this,"icaltype","utc-offset");this.fromData(t)}static fromString(t){let e={};return e.factor=t[0]==="+"?1:-1,e.hours=R(t.slice(1,3)),e.minutes=R(t.slice(4,6)),new Q(e)}static fromSeconds(t){let e=new Q;return e.fromSeconds(t),e}clone(){return Q.fromSeconds(this.toSeconds())}fromData(t){if(t)for(let[e,i]of Object.entries(t))this[e]=i;this._normalize()}fromSeconds(t){let e=Math.abs(t);return this.factor=t<0?-1:1,this.hours=P(e/3600),e-=this.hours*3600,this.minutes=P(e/60),this}toSeconds(){return this.factor*(60*this.minutes+3600*this.hours)}compare(t){let e=this.toSeconds(),i=t.toSeconds();return(e>i)-(i>e)}_normalize(){let t=this.toSeconds(),e=this.factor;for(;t<-43200;)t+=97200;for(;t>50400;)t-=97200;this.fromSeconds(t),t==0&&(this.factor=e)}toICALString(){return k.icalendar.value["utc-offset"].toICAL(this.toString())}toString(){return(this.factor==1?"+":"-")+J(this.hours)+":"+J(this.minutes)}}class ft extends g{constructor(e,i,s){super(e,i);d(this,"icalclass","vcardtime");d(this,"icaltype","date-and-or-time");this.icaltype=s||"date-and-or-time"}static fromDateAndOrTimeString(e,i){function s(T,S,at){return T?R(T.slice(S,S+at)):null}let n=e.split("T"),a=n[0],l=n[1],o=l?k.vcard.value.time._splitZone(l):[],u=o[0],h=o[1],c=a?a.length:0,f=h?h.length:0,y=a&&a[0]=="-"&&a[1]=="-",A=h&&h[0]=="-",p={year:y?null:s(a,0,4),month:y&&(c==4||c==7)?s(a,2,2):c==7||c==10?s(a,5,2):null,day:c==5?s(a,3,2):c==7&&y?s(a,5,2):c==10?s(a,8,2):null,hour:A?null:s(h,0,2),minute:A&&f==3?s(h,1,2):f>4?A?s(h,1,2):s(h,3,2):null,second:f==4?s(h,2,2):f==6?s(h,4,2):f==8?s(h,6,2):null};return u=="Z"?u=I.utcTimezone:u&&u[3]==":"?u=Q.fromString(u):u=null,new ft(p,u,i)}clone(){return new ft(this._time,this.zone,this.icaltype)}_normalize(){return this}utcOffset(){return this.zone instanceof Q?this.zone.toSeconds():g.prototype.utcOffset.apply(this,arguments)}toICALString(){return k.vcard.value[this.icaltype].toICAL(this.toString())}toString(){let e=this.year,i=this.month,s=this.day,n=this.hour,a=this.minute,l=this.second,o=e!==null,u=i!==null,h=s!==null,c=n!==null,f=a!==null,y=l!==null,A=(o?J(e)+(u||h?"-":""):u||h?"--":"")+(u?J(i):"")+(h?"-"+J(s):""),p=(c?J(n):"-")+(c&&f?":":"")+(f?J(a):"")+(!c&&!f?"-":"")+(f&&y?":":"")+(y?J(l):""),T;switch(this.zone===I.utcTimezone?T="Z":this.zone instanceof Q?T=this.zone.toString():this.zone===I.localTimezone?T="":this.zone instanceof I?T=Q.fromSeconds(this.zone.utcOffset(this)).toString():T="",this.icaltype){case"time":return p+T;case"date-and-or-time":case"date-time":return A+(p=="--"?"":"T"+p+T);case"date":return A}return null}}const q=class q{constructor(t){d(this,"completed",!1);d(this,"rule",null);d(this,"dtstart",null);d(this,"last",null);d(this,"occurrence_number",0);d(this,"by_indices",null);d(this,"initialized",!1);d(this,"by_data",null);d(this,"days",null);d(this,"days_index",0);this.fromData(t)}fromData(t){if(this.rule=st(t.rule,j),!this.rule)throw new Error("iterator requires a (ICAL.Recur) rule");if(this.dtstart=st(t.dtstart,g),!this.dtstart)throw new Error("iterator requires a (ICAL.Time) dtstart");if(t.by_data?this.by_data=t.by_data:this.by_data=Tt(this.rule.parts,!0),t.occurrence_number&&(this.occurrence_number=t.occurrence_number),this.days=t.days||[],t.last&&(this.last=st(t.last,g)),this.by_indices=t.by_indices,this.by_indices||(this.by_indices={BYSECOND:0,BYMINUTE:0,BYHOUR:0,BYDAY:0,BYMONTH:0,BYWEEKNO:0,BYMONTHDAY:0}),this.initialized=t.initialized||!1,!this.initialized)try{this.init()}catch(e){if(e instanceof ge)this.completed=!0;else throw e}}init(){this.initialized=!0,this.last=this.dtstart.clone();let t=this.by_data;if("BYDAY"in t&&this.sort_byday_rules(t.BYDAY),"BYYEARDAY"in t&&("BYMONTH"in t||"BYWEEKNO"in t||"BYMONTHDAY"in t||"BYDAY"in t))throw new Error("Invalid BYYEARDAY rule");if("BYWEEKNO"in t&&"BYMONTHDAY"in t)throw new Error("BYWEEKNO does not fit to BYMONTHDAY");if(this.rule.freq=="MONTHLY"&&("BYYEARDAY"in t||"BYWEEKNO"in t))throw new Error("For MONTHLY recurrences neither BYYEARDAY nor BYWEEKNO may appear");if(this.rule.freq=="WEEKLY"&&("BYYEARDAY"in t||"BYMONTHDAY"in t))throw new Error("For WEEKLY recurrences neither BYMONTHDAY nor BYYEARDAY may appear");if(this.rule.freq!="YEARLY"&&"BYYEARDAY"in t)throw new Error("BYYEARDAY may only appear in YEARLY rules");if(this.last.second=this.setup_defaults("BYSECOND","SECONDLY",this.dtstart.second),this.last.minute=this.setup_defaults("BYMINUTE","MINUTELY",this.dtstart.minute),this.last.hour=this.setup_defaults("BYHOUR","HOURLY",this.dtstart.hour),this.last.day=this.setup_defaults("BYMONTHDAY","DAILY",this.dtstart.day),this.last.month=this.setup_defaults("BYMONTH","MONTHLY",this.dtstart.month),this.rule.freq=="WEEKLY")if("BYDAY"in t){let[,e]=this.ruleDayOfWeek(t.BYDAY[0],this.rule.wkst),i=e-this.last.dayOfWeek(this.rule.wkst);(this.last.dayOfWeek(this.rule.wkst)<e&&i>=0||i<0)&&(this.last.day+=i)}else{let e=j.numericDayToIcalDay(this.dtstart.dayOfWeek());t.BYDAY=[e]}if(this.rule.freq=="YEARLY"){const e=this.rule.until?this.rule.until.year:2e4;for(;this.last.year<=e&&(this.expand_year_days(this.last.year),!(this.days.length>0));)this.increment_year(this.rule.interval);if(this.days.length==0)throw new ge;this._nextByYearDay()}if(this.rule.freq=="MONTHLY"){if(this.has_by_data("BYDAY")){let e=null,i=this.last.clone(),s=g.daysInMonth(this.last.month,this.last.year);for(let n of this.by_data.BYDAY){this.last=i.clone();let[a,l]=this.ruleDayOfWeek(n),o=this.last.nthWeekDay(l,a);if(a>=6||a<=-6)throw new Error("Malformed values in BYDAY part");if(o>s||o<=0){if(e&&e.month==i.month)continue;for(;o>s||o<=0;)this.increment_month(),s=g.daysInMonth(this.last.month,this.last.year),o=this.last.nthWeekDay(l,a)}this.last.day=o,(!e||this.last.compare(e)<0)&&(e=this.last.clone())}if(this.last=e.clone(),this.has_by_data("BYMONTHDAY")&&this._byDayAndMonthDay(!0),this.last.day>s||this.last.day==0)throw new Error("Malformed values in BYDAY part")}else if(this.has_by_data("BYMONTHDAY")){this.last.day=1;let e=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY).filter(i=>i>=this.last.day);if(e.length)this.last.day=e[0],this.by_data.BYMONTHDAY=e;else if(!this.next_month()&&!this.next_month()&&!this.next_month())throw new Error("No possible occurrences")}}}next(t=!1){let e=this.last?this.last.clone():null;if((this.rule.count&&this.occurrence_number>=this.rule.count||this.rule.until&&this.last.compare(this.rule.until)>0)&&(this.completed=!0),this.completed)return null;if(this.occurrence_number==0&&this.last.compare(this.dtstart)>=0)return this.occurrence_number++,this.last;let i;do switch(i=1,this.rule.freq){case"SECONDLY":this.next_second();break;case"MINUTELY":this.next_minute();break;case"HOURLY":this.next_hour();break;case"DAILY":this.next_day();break;case"WEEKLY":this.next_week();break;case"MONTHLY":i=this.next_month();break;case"YEARLY":this.next_year();break;default:return null}while(!this.check_contracting_rules()||this.last.compare(this.dtstart)<0||!i);if(this.last.compare(e)==0){if(t)throw new Error("Same occurrence found twice, protecting you from death by recursion");this.next(!0)}return this.rule.until&&this.last.compare(this.rule.until)>0?(this.completed=!0,null):(this.occurrence_number++,this.last)}next_second(){return this.next_generic("BYSECOND","SECONDLY","second","minute")}increment_second(t){return this.increment_generic(t,"second",60,"minute")}next_minute(){return this.next_generic("BYMINUTE","MINUTELY","minute","hour","next_second")}increment_minute(t){return this.increment_generic(t,"minute",60,"hour")}next_hour(){return this.next_generic("BYHOUR","HOURLY","hour","monthday","next_minute")}increment_hour(t){this.increment_generic(t,"hour",24,"monthday")}next_day(){let t=this.rule.freq=="DAILY";return this.next_hour()==0||(t?this.increment_monthday(this.rule.interval):this.increment_monthday(1)),0}next_week(){let t=0;if(this.next_weekday_by_week()==0)return t;if(this.has_by_data("BYWEEKNO")){this.by_indices.BYWEEKNO++,this.by_indices.BYWEEKNO==this.by_data.BYWEEKNO.length&&(this.by_indices.BYWEEKNO=0,t=1),this.last.month=1,this.last.day=1;let e=this.by_data.BYWEEKNO[this.by_indices.BYWEEKNO];this.last.day+=7*e,t&&this.increment_year(1)}else this.increment_monthday(7*this.rule.interval);return t}normalizeByMonthDayRules(t,e,i){let s=g.daysInMonth(e,t),n=[],a=0,l=i.length,o;for(;a<l;a++){if(o=parseInt(i[a],10),isNaN(o))throw new Error("Invalid BYMONTHDAY value");if(!(Math.abs(o)>s)){if(o<0)o=s+(o+1);else if(o===0)continue;n.indexOf(o)===-1&&n.push(o)}}return n.sort(function(u,h){return u-h})}_byDayAndMonthDay(t){let e,i=this.by_data.BYDAY,s,n=0,a,l=i.length,o=0,u,h=this,c=this.last.day;function f(){for(u=g.daysInMonth(h.last.month,h.last.year),e=h.normalizeByMonthDayRules(h.last.year,h.last.month,h.by_data.BYMONTHDAY),a=e.length;e[n]<=c&&!(t&&e[n]==c)&&n<a-1;)n++}function y(){c=0,h.increment_month(),n=0,f()}f(),t&&(c-=1);let A=48;for(;!o&&A;){if(A--,s=c+1,s>u){y();continue}let p=e[n++];if(p>=s)c=p;else{y();continue}for(let T=0;T<l;T++){let S=this.ruleDayOfWeek(i[T]),at=S[0],lt=S[1];if(this.last.day=c,this.last.isNthWeekDay(lt,at)){o=1;break}}if(!o&&n===a){y();continue}}if(A<=0)throw new Error("Malformed values in BYDAY combined with BYMONTHDAY parts");return o}next_month(){let t=1;if(this.next_hour()==0)return t;if(this.has_by_data("BYDAY")&&this.has_by_data("BYMONTHDAY"))t=this._byDayAndMonthDay();else if(this.has_by_data("BYDAY")){let e=g.daysInMonth(this.last.month,this.last.year),i=0,s=0;if(this.has_by_data("BYSETPOS")){let a=this.last.day;for(let l=1;l<=e;l++)this.last.day=l,this.is_day_in_byday(this.last)&&(s++,l<=a&&i++);this.last.day=a}t=0;let n;for(n=this.last.day+1;n<=e;n++)if(this.last.day=n,this.is_day_in_byday(this.last)&&(!this.has_by_data("BYSETPOS")||this.check_set_position(++i)||this.check_set_position(i-s-1))){t=1;break}n>e&&(this.last.day=1,this.increment_month(),this.is_day_in_byday(this.last)?(!this.has_by_data("BYSETPOS")||this.check_set_position(1))&&(t=1):t=0)}else if(this.has_by_data("BYMONTHDAY")){if(this.by_indices.BYMONTHDAY++,this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length&&(this.by_indices.BYMONTHDAY=0,this.increment_month(),this.by_indices.BYMONTHDAY>=this.by_data.BYMONTHDAY.length))return 0;let e=g.daysInMonth(this.last.month,this.last.year),i=this.by_data.BYMONTHDAY[this.by_indices.BYMONTHDAY];i<0&&(i=e+i+1),i>e?(this.last.day=1,t=this.is_day_in_byday(this.last)):this.last.day=i}else{this.increment_month();let e=g.daysInMonth(this.last.month,this.last.year);this.by_data.BYMONTHDAY[0]>e?t=0:this.last.day=this.by_data.BYMONTHDAY[0]}return t}next_weekday_by_week(){let t=0;if(this.next_hour()==0)return t;if(!this.has_by_data("BYDAY"))return 1;for(;;){let e=new g;this.by_indices.BYDAY++,this.by_indices.BYDAY==Object.keys(this.by_data.BYDAY).length&&(this.by_indices.BYDAY=0,t=1);let i=this.by_data.BYDAY[this.by_indices.BYDAY],n=this.ruleDayOfWeek(i)[1];n-=this.rule.wkst,n<0&&(n+=7),e.year=this.last.year,e.month=this.last.month,e.day=this.last.day;let a=e.startDoyWeek(this.rule.wkst);if(n+a<1&&!t)continue;let l=g.fromDayOfYear(a+n,this.last.year);return this.last.year=l.year,this.last.month=l.month,this.last.day=l.day,t}}next_year(){if(this.next_hour()==0)return 0;if(++this.days_index==this.days.length){this.days_index=0;do this.increment_year(this.rule.interval),this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY)),this.expand_year_days(this.last.year);while(this.days.length==0)}return this._nextByYearDay(),1}_nextByYearDay(){let t=this.days[this.days_index],e=this.last.year;t<1&&(t+=1,e+=1);let i=g.fromDayOfYear(t,e);this.last.day=i.day,this.last.month=i.month}ruleDayOfWeek(t,e){let i=t.match(/([+-]?[0-9])?(MO|TU|WE|TH|FR|SA|SU)/);if(i){let s=parseInt(i[1]||0,10);return t=j.icalDayToNumericDay(i[2],e),[s,t]}else return[0,0]}next_generic(t,e,i,s,n){let a=t in this.by_data,l=this.rule.freq==e,o=0;if(n&&this[n]()==0)return o;if(a){this.by_indices[t]++;let u=this.by_data[t];this.by_indices[t]==u.length&&(this.by_indices[t]=0,o=1),this.last[i]=u[this.by_indices[t]]}else l&&this["increment_"+i](this.rule.interval);return a&&o&&l&&this["increment_"+s](1),o}increment_monthday(t){for(let e=0;e<t;e++){let i=g.daysInMonth(this.last.month,this.last.year);this.last.day++,this.last.day>i&&(this.last.day-=i,this.increment_month())}}increment_month(){if(this.last.day=1,this.has_by_data("BYMONTH"))this.by_indices.BYMONTH++,this.by_indices.BYMONTH==this.by_data.BYMONTH.length&&(this.by_indices.BYMONTH=0,this.increment_year(1)),this.last.month=this.by_data.BYMONTH[this.by_indices.BYMONTH];else{this.rule.freq=="MONTHLY"?this.last.month+=this.rule.interval:this.last.month++,this.last.month--;let t=P(this.last.month/12);this.last.month%=12,this.last.month++,t!=0&&this.increment_year(t)}this.has_by_data("BYMONTHDAY")&&(this.by_data.BYMONTHDAY=this.normalizeByMonthDayRules(this.last.year,this.last.month,this.rule.parts.BYMONTHDAY))}increment_year(t){this.last.day=1,this.last.year+=t}increment_generic(t,e,i,s){this.last[e]+=t;let n=P(this.last[e]/i);this.last[e]%=i,n!=0&&this["increment_"+s](n)}has_by_data(t){return t in this.rule.parts}expand_year_days(t){let e=new g;this.days=[];let i={},s=["BYDAY","BYWEEKNO","BYMONTHDAY","BYMONTH","BYYEARDAY"];for(let l of s)l in this.rule.parts&&(i[l]=this.rule.parts[l]);if("BYMONTH"in i&&"BYWEEKNO"in i){let l=1,o={};e.year=t,e.isDate=!0;for(let u=0;u<this.by_data.BYMONTH.length;u++){let h=this.by_data.BYMONTH[u];e.month=h,e.day=1;let c=e.weekNumber(this.rule.wkst);e.day=g.daysInMonth(h,t);let f=e.weekNumber(this.rule.wkst);for(u=c;u<f;u++)o[u]=1}for(let u=0;u<this.by_data.BYWEEKNO.length&&l;u++)this.by_data.BYWEEKNO[u]<52?l&=o[u]:l=0;l?delete i.BYMONTH:delete i.BYWEEKNO}let n=Object.keys(i).length;if(n==0){let l=this.dtstart.clone();l.year=this.last.year,this.days.push(l.dayOfYear())}else if(n==1&&"BYMONTH"in i)for(let l of this.by_data.BYMONTH){let o=this.dtstart.clone();o.year=t,o.month=l,o.isDate=!0,this.days.push(o.dayOfYear())}else if(n==1&&"BYMONTHDAY"in i)for(let l of this.by_data.BYMONTHDAY){let o=this.dtstart.clone();if(l<0){let u=g.daysInMonth(o.month,t);l=l+u+1}o.day=l,o.year=t,o.isDate=!0,this.days.push(o.dayOfYear())}else if(n==2&&"BYMONTHDAY"in i&&"BYMONTH"in i)for(let l of this.by_data.BYMONTH){let o=g.daysInMonth(l,t);for(let u of this.by_data.BYMONTHDAY)u<0&&(u=u+o+1),e.day=u,e.month=l,e.year=t,e.isDate=!0,this.days.push(e.dayOfYear())}else if(!(n==1&&"BYWEEKNO"in i)){if(!(n==2&&"BYWEEKNO"in i&&"BYMONTHDAY"in i))if(n==1&&"BYDAY"in i)this.days=this.days.concat(this.expand_by_day(t));else if(n==2&&"BYDAY"in i&&"BYMONTH"in i){for(let l of this.by_data.BYMONTH){let o=g.daysInMonth(l,t);e.year=t,e.month=l,e.day=1,e.isDate=!0;let u=e.dayOfWeek(),h=e.dayOfYear()-1;e.day=o;let c=e.dayOfWeek();if(this.has_by_data("BYSETPOS")){let f=[];for(let y=1;y<=o;y++)e.day=y,this.is_day_in_byday(e)&&f.push(y);for(let y=0;y<f.length;y++)(this.check_set_position(y+1)||this.check_set_position(y-f.length))&&this.days.push(h+f[y])}else for(let f of this.by_data.BYDAY){let y=this.ruleDayOfWeek(f),A=y[0],p=y[1],T,S=(p+7-u)%7+1,at=o-(c+7-p)%7;if(A==0)for(let lt=S;lt<=o;lt+=7)this.days.push(h+lt);else A>0?(T=S+(A-1)*7,T<=o&&this.days.push(h+T)):(T=at+(A+1)*7,T>0&&this.days.push(h+T))}}this.days.sort(function(l,o){return l-o})}else if(n==2&&"BYDAY"in i&&"BYMONTHDAY"in i){let l=this.expand_by_day(t);for(let o of l){let u=g.fromDayOfYear(o,t);this.by_data.BYMONTHDAY.indexOf(u.day)>=0&&this.days.push(o)}}else if(n==3&&"BYDAY"in i&&"BYMONTHDAY"in i&&"BYMONTH"in i){let l=this.expand_by_day(t);for(let o of l){let u=g.fromDayOfYear(o,t);this.by_data.BYMONTH.indexOf(u.month)>=0&&this.by_data.BYMONTHDAY.indexOf(u.day)>=0&&this.days.push(o)}}else if(n==2&&"BYDAY"in i&&"BYWEEKNO"in i){let l=this.expand_by_day(t);for(let o of l){let h=g.fromDayOfYear(o,t).weekNumber(this.rule.wkst);this.by_data.BYWEEKNO.indexOf(h)&&this.days.push(o)}}else n==3&&"BYDAY"in i&&"BYWEEKNO"in i&&"BYMONTHDAY"in i||(n==1&&"BYYEARDAY"in i?this.days=this.days.concat(this.by_data.BYYEARDAY):this.days=[])}let a=g.isLeapYear(t)?366:365;return this.days.sort((l,o)=>(l<0&&(l+=a+1),o<0&&(o+=a+1),l-o)),0}expand_by_day(t){let e=[],i=this.last.clone();i.year=t,i.month=1,i.day=1,i.isDate=!0;let s=i.dayOfWeek();i.month=12,i.day=31,i.isDate=!0;let n=i.dayOfWeek(),a=i.dayOfYear();for(let l of this.by_data.BYDAY){let o=this.ruleDayOfWeek(l),u=o[0],h=o[1];if(u==0){let c=(h+7-s)%7+1;for(let f=c;f<=a;f+=7)e.push(f)}else if(u>0){let c;h>=s?c=h-s+1:c=h-s+8,e.push(c+(u-1)*7)}else{let c;u=-u,h<=n?c=a-n+h:c=a-n+h-7,e.push(c-(u-1)*7)}}return e}is_day_in_byday(t){if(this.by_data.BYDAY)for(let e of this.by_data.BYDAY){let i=this.ruleDayOfWeek(e),s=i[0],n=i[1],a=t.dayOfWeek();if(s==0&&n==a||t.nthWeekDay(n,s)==t.day)return 1}return 0}check_set_position(t){return this.has_by_data("BYSETPOS")?this.by_data.BYSETPOS.indexOf(t)!==-1:!1}sort_byday_rules(t){for(let e=0;e<t.length;e++)for(let i=0;i<e;i++){let s=this.ruleDayOfWeek(t[i],this.rule.wkst)[1],n=this.ruleDayOfWeek(t[e],this.rule.wkst)[1];if(s>n){let a=t[e];t[e]=t[i],t[i]=a}}}check_contract_restriction(t,e){let i=q._indexMap[t],s=q._expandMap[this.rule.freq][i],n=!1;if(t in this.by_data&&s==q.CONTRACT){let a=this.by_data[t];for(let l of a)if(l==e){n=!0;break}}else n=!0;return n}check_contracting_rules(){let t=this.last.dayOfWeek(),e=this.last.weekNumber(this.rule.wkst),i=this.last.dayOfYear();return this.check_contract_restriction("BYSECOND",this.last.second)&&this.check_contract_restriction("BYMINUTE",this.last.minute)&&this.check_contract_restriction("BYHOUR",this.last.hour)&&this.check_contract_restriction("BYDAY",j.numericDayToIcalDay(t))&&this.check_contract_restriction("BYWEEKNO",e)&&this.check_contract_restriction("BYMONTHDAY",this.last.day)&&this.check_contract_restriction("BYMONTH",this.last.month)&&this.check_contract_restriction("BYYEARDAY",i)}setup_defaults(t,e,i){let s=q._indexMap[t];return q._expandMap[this.rule.freq][s]!=q.CONTRACT&&(t in this.by_data||(this.by_data[t]=[i]),this.rule.freq!=e)?this.by_data[t][0]:i}toJSON(){let t=Object.create(null);return t.initialized=this.initialized,t.rule=this.rule.toJSON(),t.dtstart=this.dtstart.toJSON(),t.by_data=this.by_data,t.days=this.days,t.last=this.last.toJSON(),t.by_indices=this.by_indices,t.occurrence_number=this.occurrence_number,t}};d(q,"_indexMap",{BYSECOND:0,BYMINUTE:1,BYHOUR:2,BYDAY:3,BYMONTHDAY:4,BYYEARDAY:5,BYWEEKNO:6,BYMONTH:7,BYSETPOS:8}),d(q,"_expandMap",{SECONDLY:[1,1,1,1,1,1,1,1],MINUTELY:[2,1,1,1,1,1,1,1],HOURLY:[2,2,1,1,1,1,1,1],DAILY:[2,2,2,1,1,1,1,1],WEEKLY:[2,2,2,2,3,3,1,1],MONTHLY:[2,2,2,2,2,3,3,1],YEARLY:[2,2,2,2,2,2,2,2]}),d(q,"UNKNOWN",0),d(q,"CONTRACT",1),d(q,"EXPAND",2),d(q,"ILLEGAL",3);let Lt=q;class ge extends Error{constructor(){super("Recurrence rule has no valid occurrences")}}const ci=/^(SU|MO|TU|WE|TH|FR|SA)$/,di=/^([+-])?(5[0-3]|[1-4][0-9]|[1-9])?(SU|MO|TU|WE|TH|FR|SA)$/,Ce={SU:g.SUNDAY,MO:g.MONDAY,TU:g.TUESDAY,WE:g.WEDNESDAY,TH:g.THURSDAY,FR:g.FRIDAY,SA:g.SATURDAY},fi=Object.fromEntries(Object.entries(Ce).map(r=>r.reverse())),De=["SECONDLY","MINUTELY","HOURLY","DAILY","WEEKLY","MONTHLY","YEARLY"];class j{constructor(t){d(this,"parts",null);d(this,"interval",1);d(this,"wkst",g.MONDAY);d(this,"until",null);d(this,"count",null);d(this,"freq",null);d(this,"icalclass","icalrecur");d(this,"icaltype","recur");this.wrappedJSObject=this,this.parts={},t&&typeof t=="object"&&this.fromData(t)}static fromString(t){let e=this._stringToData(t,!1);return new j(e)}static fromData(t){return new j(t)}static _stringToData(t,e){let i=Object.create(null),s=t.split(";"),n=s.length;for(let a=0;a<n;a++){let l=s[a].split("="),o=l[0].toUpperCase(),u=l[0].toLowerCase(),h=e?u:o,c=l[1];if(o in se){let f=c.split(","),y=new Set;for(let A of f)y.add(se[o](A));f=[...y],i[h]=f.length==1?f[0]:f}else o in re?re[o](c,i,e):i[u]=c}return i}static icalDayToNumericDay(t,e){let i=e||g.SUNDAY;return(Ce[t]-i+7)%7+1}static numericDayToIcalDay(t,e){let i=e||g.SUNDAY,s=t+i-g.SUNDAY;return s>7&&(s-=7),fi[s]}iterator(t){return new Lt({rule:this,dtstart:t})}clone(){return new j(this.toJSON())}isFinite(){return!!(this.count||this.until)}isByCount(){return!!(this.count&&!this.until)}addComponent(t,e){let i=t.toUpperCase();i in this.parts?this.parts[i].push(e):this.parts[i]=[e]}setComponent(t,e){this.parts[t.toUpperCase()]=e.slice()}getComponent(t){let e=t.toUpperCase();return e in this.parts?this.parts[e].slice():[]}getNextOccurrence(t,e){let i=this.iterator(t),s;do s=i.next();while(s&&s.compare(e)<=0);return s&&e.zone&&(s.zone=e.zone),s}fromData(t){for(let e in t){let i=e.toUpperCase();i in se?Array.isArray(t[e])?this.parts[i]=t[e]:this.parts[i]=[t[e]]:this[e]=t[e]}this.interval&&typeof this.interval!="number"&&re.INTERVAL(this.interval,this),this.wkst&&typeof this.wkst!="number"&&(this.wkst=j.icalDayToNumericDay(this.wkst)),this.until&&!(this.until instanceof g)&&(this.until=g.fromString(this.until))}toJSON(){let t=Object.create(null);t.freq=this.freq,this.count&&(t.count=this.count),this.interval>1&&(t.interval=this.interval);for(let[e,i]of Object.entries(this.parts))Array.isArray(i)&&i.length==1?t[e.toLowerCase()]=i[0]:t[e.toLowerCase()]=Tt(i);return this.until&&(t.until=this.until.toString()),"wkst"in this&&this.wkst!==g.DEFAULT_WEEK_START&&(t.wkst=j.numericDayToIcalDay(this.wkst)),t}toString(){let t="FREQ="+this.freq;this.count&&(t+=";COUNT="+this.count),this.interval>1&&(t+=";INTERVAL="+this.interval);for(let[e,i]of Object.entries(this.parts))t+=";"+e+"="+i;return this.until&&(t+=";UNTIL="+this.until.toICALString()),"wkst"in this&&this.wkst!==g.DEFAULT_WEEK_START&&(t+=";WKST="+j.numericDayToIcalDay(this.wkst)),t}}function ot(r,t,e,i){let s=i;if(i[0]==="+"&&(s=i.slice(1)),s=R(s),t!==void 0&&i<t)throw new Error(r+': invalid value "'+i+'" must be > '+t);if(e!==void 0&&i>e)throw new Error(r+': invalid value "'+i+'" must be < '+t);return s}const re={FREQ:function(r,t,e){if(De.indexOf(r)!==-1)t.freq=r;else throw new Error('invalid frequency "'+r+'" expected: "'+De.join(", ")+'"')},COUNT:function(r,t,e){t.count=R(r)},INTERVAL:function(r,t,e){t.interval=R(r),t.interval<1&&(t.interval=1)},UNTIL:function(r,t,e){r.length>10?t.until=k.icalendar.value["date-time"].fromICAL(r):t.until=k.icalendar.value.date.fromICAL(r),e||(t.until=g.fromString(t.until))},WKST:function(r,t,e){if(ci.test(r))t.wkst=j.icalDayToNumericDay(r);else throw new Error('invalid WKST value "'+r+'"')}},se={BYSECOND:ot.bind(void 0,"BYSECOND",0,60),BYMINUTE:ot.bind(void 0,"BYMINUTE",0,59),BYHOUR:ot.bind(void 0,"BYHOUR",0,23),BYDAY:function(r){if(di.test(r))return r;throw new Error('invalid BYDAY value "'+r+'"')},BYMONTHDAY:ot.bind(void 0,"BYMONTHDAY",-31,31),BYYEARDAY:ot.bind(void 0,"BYYEARDAY",-366,366),BYWEEKNO:ot.bind(void 0,"BYWEEKNO",-53,53),BYMONTH:ot.bind(void 0,"BYMONTH",1,12),BYSETPOS:ot.bind(void 0,"BYSETPOS",-366,366)};class dt{constructor(t){d(this,"start",null);d(this,"end",null);d(this,"duration",null);d(this,"icalclass","icalperiod");d(this,"icaltype","period");if(this.wrappedJSObject=this,t&&"start"in t){if(t.start&&!(t.start instanceof g))throw new TypeError(".start must be an instance of ICAL.Time");this.start=t.start}if(t&&t.end&&t.duration)throw new Error("cannot accept both end and duration");if(t&&"end"in t){if(t.end&&!(t.end instanceof g))throw new TypeError(".end must be an instance of ICAL.Time");this.end=t.end}if(t&&"duration"in t){if(t.duration&&!(t.duration instanceof W))throw new TypeError(".duration must be an instance of ICAL.Duration");this.duration=t.duration}}static fromString(t,e){let i=t.split("/");if(i.length!==2)throw new Error('Invalid string value: "'+t+'" must contain a "/" char.');let s={start:g.fromDateTimeString(i[0],e)},n=i[1];return W.isValueString(n)?s.duration=W.fromString(n):s.end=g.fromDateTimeString(n,e),new dt(s)}static fromData(t){return new dt(t)}static fromJSON(t,e,i){function s(n,a){return i?g.fromString(n,a):g.fromDateTimeString(n,a)}return W.isValueString(t[1])?dt.fromData({start:s(t[0],e),duration:W.fromString(t[1])}):dt.fromData({start:s(t[0],e),end:s(t[1],e)})}clone(){return dt.fromData({start:this.start?this.start.clone():null,end:this.end?this.end.clone():null,duration:this.duration?this.duration.clone():null})}getDuration(){return this.duration?this.duration:this.end.subtractDate(this.start)}getEnd(){if(this.end)return this.end;{let t=this.start.clone();return t.addDuration(this.duration),t}}toString(){return this.start+"/"+(this.end||this.duration)}toJSON(){return[this.start.toString(),(this.end||this.duration).toString()]}toICALString(){return this.start.toICALString()+"/"+(this.end||this.duration).toICALString()}}const mi=/\\\\|\\;|\\,|\\[Nn]/g,pi=/\\|;|,|\n/g,Te=/\\\\|\\,|\\[Nn]/g,Ye=/\\|,|\n/g;function ae(r,t){return{matches:/.*/,fromICAL:function(i,s){return _i(i,r,s)},toICAL:function(i,s){let n=t;return s&&(n=new RegExp(n.source+"|"+s,n.flags)),i.replace(n,function(a){switch(a){case"\\":return"\\\\";case";":return"\\;";case",":return"\\,";case`
`:return"\\n";default:return a}})}}}const v={defaultType:"text"},Bt={defaultType:"text",multiValue:","},Zt={defaultType:"text",structuredValue:";"},Rt={defaultType:"integer"},jt={defaultType:"date-time",allowedTypes:["date-time","date"]},Wt={defaultType:"date-time"},K={defaultType:"uri"},Ae={defaultType:"utc-offset"},Ee={defaultType:"recur"},we={defaultType:"date-and-or-time",allowedTypes:["date-time","date","text"]};function yi(r){switch(r){case"\\\\":return"\\";case"\\;":return";";case"\\,":return",";case"\\n":case"\\N":return`
`;default:return r}}function _i(r,t,e){return r.indexOf("\\")===-1?r:(e&&(t=new RegExp(t.source+"|\\\\"+e,t.flags)),r.replace(t,yi))}let le={categories:Bt,url:K,version:v,uid:v},oe={boolean:{values:["TRUE","FALSE"],fromICAL:function(r){switch(r){case"TRUE":return!0;case"FALSE":return!1;default:return!1}},toICAL:function(r){return r?"TRUE":"FALSE"}},float:{matches:/^[+-]?\d+\.\d+$/,fromICAL:function(r){let t=parseFloat(r);return Mt(t)?0:t},toICAL:function(r){return String(r)}},integer:{fromICAL:function(r){let t=parseInt(r);return Mt(t)?0:t},toICAL:function(r){return String(r)}},"utc-offset":{toICAL:function(r){return r.length<7?r.slice(0,3)+r.slice(4,6):r.slice(0,3)+r.slice(4,6)+r.slice(7,9)},fromICAL:function(r){return r.length<6?r.slice(0,3)+":"+r.slice(3,5):r.slice(0,3)+":"+r.slice(3,5)+":"+r.slice(5,7)},decorate:function(r){return Q.fromString(r)},undecorate:function(r){return r.toString()}}},gi={cutype:{values:["INDIVIDUAL","GROUP","RESOURCE","ROOM","UNKNOWN"],allowXName:!0,allowIanaToken:!0},"delegated-from":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},"delegated-to":{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},encoding:{values:["8BIT","BASE64"]},fbtype:{values:["FREE","BUSY","BUSY-UNAVAILABLE","BUSY-TENTATIVE"],allowXName:!0,allowIanaToken:!0},member:{valueType:"cal-address",multiValue:",",multiValueSeparateDQuote:!0},partstat:{values:["NEEDS-ACTION","ACCEPTED","DECLINED","TENTATIVE","DELEGATED","COMPLETED","IN-PROCESS"],allowXName:!0,allowIanaToken:!0},range:{values:["THISANDFUTURE"]},related:{values:["START","END"]},reltype:{values:["PARENT","CHILD","SIBLING"],allowXName:!0,allowIanaToken:!0},role:{values:["REQ-PARTICIPANT","CHAIR","OPT-PARTICIPANT","NON-PARTICIPANT"],allowXName:!0,allowIanaToken:!0},rsvp:{values:["TRUE","FALSE"]},"sent-by":{valueType:"cal-address"},tzid:{matches:/^\//},value:{values:["binary","boolean","cal-address","date","date-time","duration","float","integer","period","recur","text","time","uri","utc-offset"],allowXName:!0,allowIanaToken:!0}};const U=Yt(oe,{text:ae(mi,pi),uri:{},binary:{decorate:function(r){return Gt.fromString(r)},undecorate:function(r){return r.toString()}},"cal-address":{},date:{decorate:function(r,t){return g.fromDateString(r,t)},undecorate:function(r){return r.toString()},fromICAL:function(r){return r.slice(0,4)+"-"+r.slice(4,6)+"-"+r.slice(6,8)},toICAL:function(r){let t=r.length;return t==10?r.slice(0,4)+r.slice(5,7)+r.slice(8,10):t>=19?U["date-time"].toICAL(r):r}},"date-time":{fromICAL:function(r){{let t=r.slice(0,4)+"-"+r.slice(4,6)+"-"+r.slice(6,8)+"T"+r.slice(9,11)+":"+r.slice(11,13)+":"+r.slice(13,15);return r[15]&&r[15]==="Z"&&(t+="Z"),t}},toICAL:function(r){let t=r.length;if(t==10&&!Ot.strict)return U.date.toICAL(r);if(t>=19){let e=r.slice(0,4)+r.slice(5,7)+r.slice(8,13)+r.slice(14,16)+r.slice(17,19);return r[19]&&r[19]==="Z"&&(e+="Z"),e}else return r},decorate:function(r,t){return g.fromDateTimeString(r,t)},undecorate:function(r){return r.toString()}},duration:{decorate:function(r){return W.fromString(r)},undecorate:function(r){return r.toString()}},period:{fromICAL:function(r){let t=r.split("/");return t[0]=U["date-time"].fromICAL(t[0]),W.isValueString(t[1])||(t[1]=U["date-time"].fromICAL(t[1])),t},toICAL:function(r){return r=r.slice(),r[0]=U["date-time"].toICAL(r[0]),W.isValueString(r[1])||(r[1]=U["date-time"].toICAL(r[1])),r.join("/")},decorate:function(r,t){return dt.fromJSON(r,t,!Ot.strict)},undecorate:function(r){return r.toJSON()}},recur:{fromICAL:function(r){return j._stringToData(r,!0)},toICAL:function(r){let t="";for(let[e,i]of Object.entries(r))e=="until"?i.length>10?i=U["date-time"].toICAL(i):i=U.date.toICAL(i):e=="wkst"?typeof i=="number"&&(i=j.numericDayToIcalDay(i)):Array.isArray(i)&&(i=i.join(",")),t+=e.toUpperCase()+"="+i+";";return t.slice(0,Math.max(0,t.length-1))},decorate:function(t){return j.fromData(t)},undecorate:function(r){return r.toJSON()}},time:{fromICAL:function(r){if(r.length<6)return r;let t=r.slice(0,2)+":"+r.slice(2,4)+":"+r.slice(4,6);return r[6]==="Z"&&(t+="Z"),t},toICAL:function(r){if(r.length<8)return r;let t=r.slice(0,2)+r.slice(3,5)+r.slice(6,8);return r[8]==="Z"&&(t+="Z"),t}}});let Di=Yt(le,{action:v,attach:{defaultType:"uri"},attendee:{defaultType:"cal-address"},calscale:v,class:v,comment:v,completed:Wt,contact:v,created:Wt,description:v,dtend:jt,dtstamp:Wt,dtstart:jt,due:jt,duration:{defaultType:"duration"},exdate:{defaultType:"date-time",allowedTypes:["date-time","date"],multiValue:","},exrule:Ee,freebusy:{defaultType:"period",multiValue:","},geo:{defaultType:"float",structuredValue:";"},"last-modified":Wt,location:v,method:v,organizer:{defaultType:"cal-address"},"percent-complete":Rt,priority:Rt,prodid:v,"related-to":v,repeat:Rt,rdate:{defaultType:"date-time",allowedTypes:["date-time","date","period"],multiValue:",",detectType:function(r){return r.indexOf("/")!==-1?"period":r.indexOf("T")===-1?"date":"date-time"}},"recurrence-id":jt,resources:Bt,"request-status":Zt,rrule:Ee,sequence:Rt,status:v,summary:v,transp:v,trigger:{defaultType:"duration",allowedTypes:["duration","date-time"]},tzoffsetfrom:Ae,tzoffsetto:Ae,tzurl:K,tzid:v,tzname:v});const $=Yt(oe,{text:ae(Te,Ye),uri:ae(Te,Ye),date:{decorate:function(r){return ft.fromDateAndOrTimeString(r,"date")},undecorate:function(r){return r.toString()},fromICAL:function(r){return r.length==8?U.date.fromICAL(r):r[0]=="-"&&r.length==6?r.slice(0,4)+"-"+r.slice(4):r},toICAL:function(r){return r.length==10?U.date.toICAL(r):r[0]=="-"&&r.length==7?r.slice(0,4)+r.slice(5):r}},time:{decorate:function(r){return ft.fromDateAndOrTimeString("T"+r,"time")},undecorate:function(r){return r.toString()},fromICAL:function(r){let t=$.time._splitZone(r,!0),e=t[0],i=t[1];return i.length==6?i=i.slice(0,2)+":"+i.slice(2,4)+":"+i.slice(4,6):i.length==4&&i[0]!="-"?i=i.slice(0,2)+":"+i.slice(2,4):i.length==5&&(i=i.slice(0,3)+":"+i.slice(3,5)),e.length==5&&(e[0]=="-"||e[0]=="+")&&(e=e.slice(0,3)+":"+e.slice(3)),i+e},toICAL:function(r){let t=$.time._splitZone(r),e=t[0],i=t[1];return i.length==8?i=i.slice(0,2)+i.slice(3,5)+i.slice(6,8):i.length==5&&i[0]!="-"?i=i.slice(0,2)+i.slice(3,5):i.length==6&&(i=i.slice(0,3)+i.slice(4,6)),e.length==6&&(e[0]=="-"||e[0]=="+")&&(e=e.slice(0,3)+e.slice(4)),i+e},_splitZone:function(r,t){let e=r.length-1,i=r.length-(t?5:6),s=r[i],n,a;return r[e]=="Z"?(n=r[e],a=r.slice(0,Math.max(0,e))):r.length>6&&(s=="-"||s=="+")?(n=r.slice(i),a=r.slice(0,Math.max(0,i))):(n="",a=r),[n,a]}},"date-time":{decorate:function(r){return ft.fromDateAndOrTimeString(r,"date-time")},undecorate:function(r){return r.toString()},fromICAL:function(r){return $["date-and-or-time"].fromICAL(r)},toICAL:function(r){return $["date-and-or-time"].toICAL(r)}},"date-and-or-time":{decorate:function(r){return ft.fromDateAndOrTimeString(r,"date-and-or-time")},undecorate:function(r){return r.toString()},fromICAL:function(r){let t=r.split("T");return(t[0]?$.date.fromICAL(t[0]):"")+(t[1]?"T"+$.time.fromICAL(t[1]):"")},toICAL:function(r){let t=r.split("T");return $.date.toICAL(t[0])+(t[1]?"T"+$.time.toICAL(t[1]):"")}},timestamp:U["date-time"],"language-tag":{matches:/^[a-zA-Z0-9-]+$/},"phone-number":{fromICAL:function(r){return Array.from(r).filter(function(t){return t==="\\"?void 0:t}).join("")},toICAL:function(r){return Array.from(r).map(function(t){return t===","||t===";"?"\\"+t:t}).join("")}}});let Ti={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","time","date-time","date-and-or-time","timestamp","boolean","integer","float","utc-offset","language-tag"],allowXName:!0,allowIanaToken:!0}},Yi=Yt(le,{adr:{defaultType:"text",structuredValue:";",multiValue:","},anniversary:we,bday:we,caladruri:K,caluri:K,clientpidmap:Zt,email:v,fburl:K,fn:v,gender:Zt,geo:K,impp:K,key:K,kind:v,lang:{defaultType:"language-tag"},logo:K,member:K,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:Bt,note:v,org:{defaultType:"text",structuredValue:";"},photo:K,related:K,rev:{defaultType:"timestamp"},role:v,sound:K,source:K,tel:{defaultType:"uri",allowedTypes:["uri","text"]},title:v,tz:{defaultType:"text",allowedTypes:["text","utc-offset","uri"]},xml:v}),Ai=Yt(oe,{binary:U.binary,date:$.date,"date-time":$["date-time"],"phone-number":$["phone-number"],uri:U.uri,text:U.text,time:U.time,vcard:U.text,"utc-offset":{toICAL:function(r){return r.slice(0,7)},fromICAL:function(r){return r.slice(0,7)},decorate:function(r){return Q.fromString(r)},undecorate:function(r){return r.toString()}}}),Ei={type:{valueType:"text",multiValue:","},value:{values:["text","uri","date","date-time","phone-number","time","boolean","integer","float","utc-offset","vcard","binary"],allowXName:!0,allowIanaToken:!0}},wi=Yt(le,{fn:v,n:{defaultType:"text",structuredValue:";",multiValue:","},nickname:Bt,photo:{defaultType:"binary",allowedTypes:["binary","uri"]},bday:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(r){return r.indexOf("T")===-1?"date":"date-time"}},adr:{defaultType:"text",structuredValue:";",multiValue:","},label:v,tel:{defaultType:"phone-number"},email:v,mailer:v,tz:{defaultType:"utc-offset",allowedTypes:["utc-offset","text"]},geo:{defaultType:"float",structuredValue:";"},title:v,role:v,logo:{defaultType:"binary",allowedTypes:["binary","uri"]},agent:{defaultType:"vcard",allowedTypes:["vcard","text","uri"]},org:Zt,note:Bt,prodid:v,rev:{defaultType:"date-time",allowedTypes:["date-time","date"],detectType:function(r){return r.indexOf("T")===-1?"date":"date-time"}},"sort-string":v,sound:{defaultType:"binary",allowedTypes:["binary","uri"]},class:v,key:{defaultType:"binary",allowedTypes:["binary","text"]}}),it={value:U,param:gi,property:Di,propertyGroups:!1},Oe={value:$,param:Ti,property:Yi,propertyGroups:!0},ve={value:Ai,param:Ei,property:wi,propertyGroups:!0};const Ot={strict:!0,defaultSet:it,defaultType:"unknown",components:{vcard:Oe,vcard3:ve,vevent:it,vtodo:it,vjournal:it,valarm:it,vtimezone:it,daylight:it,standard:it},icalendar:it,vcard:Oe,vcard3:ve,getDesignSet:function(r){return r&&r in Ot.components?Ot.components[r]:Ot.defaultSet}};var k=Ot;const Kt=`\r
`,be="unknown",Oi={'"':"^'","\n":"^n","^":"^^"};function M(r){typeof r[0]=="string"&&(r=[r]);let t=0,e=r.length,i="";for(;t<e;t++)i+=M.component(r[t])+Kt;return i}M.component=function(r,t){let e=r[0].toUpperCase(),i="BEGIN:"+e+Kt,s=r[1],n=0,a=s.length,l=r[0];for(l==="vcard"&&r[1].length>0&&!(r[1][0][0]==="version"&&r[1][0][3]==="4.0")&&(l="vcard3"),t=t||k.getDesignSet(l);n<a;n++)i+=M.property(s[n],t)+Kt;let o=r[2]||[],u=0,h=o.length;for(;u<h;u++)i+=M.component(o[u],t)+Kt;return i+="END:"+e,i};M.property=function(r,t,e){let i=r[0].toUpperCase(),s=r[0],n=r[1];t||(t=k.defaultSet);let a=n.group,l;t.propertyGroups&&a?l=a.toUpperCase()+"."+i:l=i;for(let[y,A]of Object.entries(n)){if(t.propertyGroups&&y=="group")continue;let p=t.param[y],T=p&&p.multiValue;T&&Array.isArray(A)?(A=A.map(function(S){return S=M._rfc6868Unescape(S),S=M.paramPropertyValue(S,p.multiValueSeparateDQuote),S}),A=M.multiValue(A,T,"unknown",null,t)):(A=M._rfc6868Unescape(A),A=M.paramPropertyValue(A)),l+=";"+y.toUpperCase()+"="+A}if(r.length===3)return l+":";let o=r[2],u,h=!1,c=!1,f=!1;return s in t.property?(u=t.property[s],"multiValue"in u&&(h=u.multiValue),"structuredValue"in u&&Array.isArray(r[3])&&(c=u.structuredValue),"defaultType"in u?o===u.defaultType&&(f=!0):o===be&&(f=!0)):o===be&&(f=!0),f||(l+=";VALUE="+o.toUpperCase()),l+=":",h&&c?l+=M.multiValue(r[3],c,o,h,t,c):h?l+=M.multiValue(r.slice(3),h,o,null,t,!1):c?l+=M.multiValue(r[3],c,o,null,t,c):l+=M.value(r[3],o,t,!1),e?l:Ie(l)};M.paramPropertyValue=function(r,t){return!t&&r.indexOf(",")===-1&&r.indexOf(":")===-1&&r.indexOf(";")===-1?r:'"'+r+'"'};M.multiValue=function(r,t,e,i,s,n){let a="",l=r.length,o=0;for(;o<l;o++)i&&Array.isArray(r[o])?a+=M.multiValue(r[o],i,e,null,s,n):a+=M.value(r[o],e,s,n),o!==l-1&&(a+=t);return a};M.value=function(r,t,e,i){return t in e.value&&"toICAL"in e.value[t]?e.value[t].toICAL(r,i):r};M._rfc6868Unescape=function(r){return r.replace(/[\n^"]/g,function(t){return Oi[t]})};const xe=0,Ft=1,Vt=2,ut=3;class Dt{static fromString(t,e){return new Dt(N.property(t,e))}constructor(t,e){this._parent=e||null,typeof t=="string"?(this.jCal=[t,{},k.defaultType],this.jCal[Vt]=this.getDefaultType()):this.jCal=t,this._updateType()}get type(){return this.jCal[Vt]}get name(){return this.jCal[xe]}get parent(){return this._parent}set parent(t){let e=!this._parent||t&&t._designSet!=this._parent._designSet;this._parent=t,this.type==k.defaultType&&e&&(this.jCal[Vt]=this.getDefaultType(),this._updateType())}get _designSet(){return this.parent?this.parent._designSet:k.defaultSet}_updateType(){let t=this._designSet;this.type in t.value&&("decorate"in t.value[this.type]?this.isDecorated=!0:this.isDecorated=!1,this.name in t.property&&(this.isMultiValue="multiValue"in t.property[this.name],this.isStructuredValue="structuredValue"in t.property[this.name]))}_hydrateValue(t){return this._values&&this._values[t]?this._values[t]:this.jCal.length<=ut+t?null:this.isDecorated?(this._values||(this._values=[]),this._values[t]=this._decorate(this.jCal[ut+t])):this.jCal[ut+t]}_decorate(t){return this._designSet.value[this.type].decorate(t,this)}_undecorate(t){return this._designSet.value[this.type].undecorate(t,this)}_setDecoratedValue(t,e){this._values||(this._values=[]),typeof t=="object"&&"icaltype"in t?(this.jCal[ut+e]=this._undecorate(t),this._values[e]=t):(this.jCal[ut+e]=t,this._values[e]=this._decorate(t))}getParameter(t){if(t in this.jCal[Ft])return this.jCal[Ft][t]}getFirstParameter(t){let e=this.getParameter(t);return Array.isArray(e)?e[0]:e}setParameter(t,e){let i=t.toLowerCase();typeof e=="string"&&i in this._designSet.param&&"multiValue"in this._designSet.param[i]&&(e=[e]),this.jCal[Ft][t]=e}removeParameter(t){delete this.jCal[Ft][t]}getDefaultType(){let t=this.jCal[xe],e=this._designSet;if(t in e.property){let i=e.property[t];if("defaultType"in i)return i.defaultType}return k.defaultType}resetType(t){this.removeAllValues(),this.jCal[Vt]=t,this._updateType()}getFirstValue(){return this._hydrateValue(0)}getValues(){let t=this.jCal.length-ut;if(t<1)return[];let e=0,i=[];for(;e<t;e++)i[e]=this._hydrateValue(e);return i}removeAllValues(){this._values&&(this._values.length=0),this.jCal.length=3}setValues(t){if(!this.isMultiValue)throw new Error(this.name+`: does not not support mulitValue.
override isMultiValue`);let e=t.length,i=0;if(this.removeAllValues(),e>0&&typeof t[0]=="object"&&"icaltype"in t[0]&&this.resetType(t[0].icaltype),this.isDecorated)for(;i<e;i++)this._setDecoratedValue(t[i],i);else for(;i<e;i++)this.jCal[ut+i]=t[i]}setValue(t){this.removeAllValues(),typeof t=="object"&&"icaltype"in t&&this.resetType(t.icaltype),this.isDecorated?this._setDecoratedValue(t,0):this.jCal[ut]=t}toJSON(){return this.jCal}toICALString(){return M.property(this.jCal,this._designSet,!0)}}const ht=0,rt=1,ct=2;class X{constructor(t,e){d(this,"_hydratedPropertyCount",0);d(this,"_hydratedComponentCount",0);d(this,"_timezoneCache",null);d(this,"_components",null);d(this,"_properties",null);typeof t=="string"&&(t=[t,[],[]]),this.jCal=t,this.parent=e||null,!this.parent&&this.name==="vcalendar"&&(this._timezoneCache=new Map)}static fromString(t){return new X(N.component(t))}get name(){return this.jCal[ht]}get _designSet(){return this.parent&&this.parent._designSet||k.getDesignSet(this.name)}_hydrateComponent(t){if(this._components||(this._components=[],this._hydratedComponentCount=0),this._components[t])return this._components[t];let e=new X(this.jCal[ct][t],this);return this._hydratedComponentCount++,this._components[t]=e}_hydrateProperty(t){if(this._properties||(this._properties=[],this._hydratedPropertyCount=0),this._properties[t])return this._properties[t];let e=new Dt(this.jCal[rt][t],this);return this._hydratedPropertyCount++,this._properties[t]=e}getFirstSubcomponent(t){if(t){let e=0,i=this.jCal[ct],s=i.length;for(;e<s;e++)if(i[e][ht]===t)return this._hydrateComponent(e)}else if(this.jCal[ct].length)return this._hydrateComponent(0);return null}getAllSubcomponents(t){let e=this.jCal[ct].length,i=0;if(t){let s=this.jCal[ct],n=[];for(;i<e;i++)t===s[i][ht]&&n.push(this._hydrateComponent(i));return n}else{if(!this._components||this._hydratedComponentCount!==e)for(;i<e;i++)this._hydrateComponent(i);return this._components||[]}}hasProperty(t){let e=this.jCal[rt],i=e.length,s=0;for(;s<i;s++)if(e[s][ht]===t)return!0;return!1}getFirstProperty(t){if(t){let e=0,i=this.jCal[rt],s=i.length;for(;e<s;e++)if(i[e][ht]===t)return this._hydrateProperty(e)}else if(this.jCal[rt].length)return this._hydrateProperty(0);return null}getFirstPropertyValue(t){let e=this.getFirstProperty(t);return e?e.getFirstValue():null}getAllProperties(t){let e=this.jCal[rt].length,i=0;if(t){let s=this.jCal[rt],n=[];for(;i<e;i++)t===s[i][ht]&&n.push(this._hydrateProperty(i));return n}else{if(!this._properties||this._hydratedPropertyCount!==e)for(;i<e;i++)this._hydrateProperty(i);return this._properties||[]}}_removeObjectByIndex(t,e,i){if(e=e||[],e[i]){let s=e[i];"parent"in s&&(s.parent=null)}e.splice(i,1),this.jCal[t].splice(i,1)}_removeObject(t,e,i){let s=0,n=this.jCal[t],a=n.length,l=this[e];if(typeof i=="string"){for(;s<a;s++)if(n[s][ht]===i)return this._removeObjectByIndex(t,l,s),!0}else if(l){for(;s<a;s++)if(l[s]&&l[s]===i)return this._removeObjectByIndex(t,l,s),!0}return!1}_removeAllObjects(t,e,i){let s=this[e],n=this.jCal[t],a=n.length-1;for(;a>=0;a--)(!i||n[a][ht]===i)&&this._removeObjectByIndex(t,s,a)}addSubcomponent(t){this._components||(this._components=[],this._hydratedComponentCount=0),t.parent&&t.parent.removeSubcomponent(t);let e=this.jCal[ct].push(t.jCal);return this._components[e-1]=t,this._hydratedComponentCount++,t.parent=this,t}removeSubcomponent(t){let e=this._removeObject(ct,"_components",t);return e&&this._hydratedComponentCount--,e}removeAllSubcomponents(t){let e=this._removeAllObjects(ct,"_components",t);return this._hydratedComponentCount=0,e}addProperty(t){if(!(t instanceof Dt))throw new TypeError("must be instance of ICAL.Property");this._properties||(this._properties=[],this._hydratedPropertyCount=0),t.parent&&t.parent.removeProperty(t);let e=this.jCal[rt].push(t.jCal);return this._properties[e-1]=t,this._hydratedPropertyCount++,t.parent=this,t}addPropertyWithValue(t,e){let i=new Dt(t);return i.setValue(e),this.addProperty(i),i}updatePropertyWithValue(t,e){let i=this.getFirstProperty(t);return i?i.setValue(e):i=this.addPropertyWithValue(t,e),i}removeProperty(t){let e=this._removeObject(rt,"_properties",t);return e&&this._hydratedPropertyCount--,e}removeAllProperties(t){let e=this._removeAllObjects(rt,"_properties",t);return this._hydratedPropertyCount=0,e}toJSON(){return this.jCal}toString(){return M.component(this.jCal,this._designSet)}getTimeZoneByID(t){if(this.parent)return this.parent.getTimeZoneByID(t);if(!this._timezoneCache)return null;if(this._timezoneCache.has(t))return this._timezoneCache.get(t);const e=this.getAllSubcomponents("vtimezone");for(const i of e)if(i.getFirstProperty("tzid").getFirstValue()===t){const s=new I({component:i,tzid:t});return this._timezoneCache.set(t,s),s}return null}}class Me{constructor(t){d(this,"complete",!1);d(this,"ruleIterators",null);d(this,"ruleDates",null);d(this,"exDates",null);d(this,"ruleDateInc",0);d(this,"exDateInc",0);d(this,"exDate",null);d(this,"ruleDate",null);d(this,"dtstart",null);d(this,"last",null);this.ruleDates=[],this.exDates=[],this.fromData(t)}fromData(t){let e=st(t.dtstart,g);if(e)this.dtstart=e;else throw new Error(".dtstart (ICAL.Time) must be given");if(t.component)this._init(t.component);else{if(this.last=st(t.last,g)||e.clone(),!t.ruleIterators)throw new Error(".ruleIterators or .component must be given");this.ruleIterators=t.ruleIterators.map(function(i){return st(i,Lt)}),this.ruleDateInc=t.ruleDateInc,this.exDateInc=t.exDateInc,t.ruleDates&&(this.ruleDates=t.ruleDates.map(i=>st(i,g)),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.exDates&&(this.exDates=t.exDates.map(i=>st(i,g)),this.exDate=this.exDates[this.exDateInc]),typeof t.complete<"u"&&(this.complete=t.complete)}}next(){let t,e,i,s=500,n=0;for(;;){if(n++>s)throw new Error("max tries have occurred, rule may be impossible to fulfill.");if(e=this.ruleDate,t=this._nextRecurrenceIter(this.last),!e&&!t){this.complete=!0;break}if((!e||t&&e.compare(t.last)>0)&&(e=t.last.clone(),t.next()),this.ruleDate===e&&this._nextRuleDay(),this.last=e,this.exDate&&(i=this.exDate.compare(this.last),i<0&&this._nextExDay(),i===0)){this._nextExDay();continue}return this.last}}toJSON(){function t(i){return i.toJSON()}let e=Object.create(null);return e.ruleIterators=this.ruleIterators.map(t),this.ruleDates&&(e.ruleDates=this.ruleDates.map(t)),this.exDates&&(e.exDates=this.exDates.map(t)),e.ruleDateInc=this.ruleDateInc,e.exDateInc=this.exDateInc,e.last=this.last.toJSON(),e.dtstart=this.dtstart.toJSON(),e.complete=this.complete,e}_extractDates(t,e){let i=[],s=t.getAllProperties(e);for(let n=0,a=s.length;n<a;n++)for(let l of s[n].getValues()){let o=gt(i,l,(u,h)=>u.compare(h));i.splice(o,0,l)}return i}_init(t){if(this.ruleIterators=[],this.last=this.dtstart.clone(),!t.hasProperty("rdate")&&!t.hasProperty("rrule")&&!t.hasProperty("recurrence-id")){this.ruleDate=this.last.clone(),this.complete=!0;return}if(t.hasProperty("rdate")&&(this.ruleDates=this._extractDates(t,"rdate"),this.ruleDates[0]&&this.ruleDates[0].compare(this.dtstart)<0?(this.ruleDateInc=0,this.last=this.ruleDates[0].clone()):this.ruleDateInc=gt(this.ruleDates,this.last,(e,i)=>e.compare(i)),this.ruleDate=this.ruleDates[this.ruleDateInc]),t.hasProperty("rrule")){let e=t.getAllProperties("rrule"),i=0,s=e.length,n,a;for(;i<s;i++)n=e[i].getFirstValue(),a=n.iterator(this.dtstart),this.ruleIterators.push(a),a.next()}t.hasProperty("exdate")&&(this.exDates=this._extractDates(t,"exdate"),this.exDateInc=gt(this.exDates,this.last,(e,i)=>e.compare(i)),this.exDate=this.exDates[this.exDateInc])}_nextExDay(){this.exDate=this.exDates[++this.exDateInc]}_nextRuleDay(){this.ruleDate=this.ruleDates[++this.ruleDateInc]}_nextRecurrenceIter(){let t=this.ruleIterators;if(t.length===0)return null;let e=t.length,i,s,n=0,a;for(;n<e;n++){if(i=t[n],s=i.last,i.completed){e--,n!==0&&n--,t.splice(n,1);continue}(!a||a.last.compare(s)>0)&&(a=i)}return a}}const Ct=class Ct{constructor(t,e){d(this,"exceptions",null);d(this,"strictExceptions",!1);t instanceof X||(e=t,t=null),t?this.component=t:this.component=new X("vevent"),this._rangeExceptionCache=Object.create(null),this.exceptions=Object.create(null),this.rangeExceptions=[],e&&e.strictExceptions&&(this.strictExceptions=e.strictExceptions),e&&e.exceptions?e.exceptions.forEach(this.relateException,this):this.component.parent&&!this.isRecurrenceException()&&this.component.parent.getAllSubcomponents("vevent").forEach(function(i){i.hasProperty("recurrence-id")&&this.relateException(i)},this)}relateException(t){if(this.isRecurrenceException())throw new Error("cannot relate exception to exceptions");if(t instanceof X&&(t=new Ct(t)),this.strictExceptions&&t.uid!==this.uid)throw new Error("attempted to relate unrelated exception");let e=t.recurrenceId.toString();if(this.exceptions[e]=t,t.modifiesFuture()){let i=[t.recurrenceId.toUnixTime(),e],s=gt(this.rangeExceptions,i,Ne);this.rangeExceptions.splice(s,0,i)}}modifiesFuture(){return this.component.hasProperty("recurrence-id")?this.component.getFirstProperty("recurrence-id").getParameter("range")===Ct.THISANDFUTURE:!1}findRangeException(t){if(!this.rangeExceptions.length)return null;let e=t.toUnixTime(),i=gt(this.rangeExceptions,[e],Ne);if(i-=1,i<0)return null;let s=this.rangeExceptions[i];return e<s[0]?null:s[1]}getOccurrenceDetails(t){let e=t.toString(),i=t.convertToZone(I.utcTimezone).toString(),s,n={recurrenceId:t};if(e in this.exceptions)s=n.item=this.exceptions[e],n.startDate=s.startDate,n.endDate=s.endDate,n.item=s;else if(i in this.exceptions)s=this.exceptions[i],n.startDate=s.startDate,n.endDate=s.endDate,n.item=s;else{let a=this.findRangeException(t),l;if(a){let o=this.exceptions[a];n.item=o;let u=this._rangeExceptionCache[a];if(!u){let c=o.recurrenceId.clone(),f=o.startDate.clone();c.zone=f.zone,u=f.subtractDate(c),this._rangeExceptionCache[a]=u}let h=t.clone();h.zone=o.startDate.zone,h.addDuration(u),l=h.clone(),l.addDuration(o.duration),n.startDate=h,n.endDate=l}else l=t.clone(),l.addDuration(this.duration),n.endDate=l,n.startDate=t,n.item=this}return n}iterator(t){return new Me({component:this.component,dtstart:t||this.startDate})}isRecurring(){let t=this.component;return t.hasProperty("rrule")||t.hasProperty("rdate")}isRecurrenceException(){return this.component.hasProperty("recurrence-id")}getRecurrenceTypes(){let t=this.component.getAllProperties("rrule"),e=0,i=t.length,s=Object.create(null);for(;e<i;e++){let n=t[e].getFirstValue();s[n.freq]=!0}return s}get uid(){return this._firstProp("uid")}set uid(t){this._setProp("uid",t)}get startDate(){return this._firstProp("dtstart")}set startDate(t){this._setTime("dtstart",t)}get endDate(){let t=this._firstProp("dtend");if(!t){let e=this._firstProp("duration");t=this.startDate.clone(),e?t.addDuration(e):t.isDate&&(t.day+=1)}return t}set endDate(t){this.component.hasProperty("duration")&&this.component.removeProperty("duration"),this._setTime("dtend",t)}get duration(){let t=this._firstProp("duration");return t||this.endDate.subtractDateTz(this.startDate)}set duration(t){this.component.hasProperty("dtend")&&this.component.removeProperty("dtend"),this._setProp("duration",t)}get location(){return this._firstProp("location")}set location(t){this._setProp("location",t)}get attendees(){return this.component.getAllProperties("attendee")}get summary(){return this._firstProp("summary")}set summary(t){this._setProp("summary",t)}get description(){return this._firstProp("description")}set description(t){this._setProp("description",t)}get color(){return this._firstProp("color")}set color(t){this._setProp("color",t)}get organizer(){return this._firstProp("organizer")}set organizer(t){this._setProp("organizer",t)}get sequence(){return this._firstProp("sequence")}set sequence(t){this._setProp("sequence",t)}get recurrenceId(){return this._firstProp("recurrence-id")}set recurrenceId(t){this._setTime("recurrence-id",t)}_setTime(t,e){let i=this.component.getFirstProperty(t);i||(i=new Dt(t),this.component.addProperty(i)),e.zone===I.localTimezone||e.zone===I.utcTimezone?i.removeParameter("tzid"):i.setParameter("tzid",e.zone.tzid),i.setValue(e)}_setProp(t,e){this.component.updatePropertyWithValue(t,e)}_firstProp(t){return this.component.getFirstPropertyValue(t)}toString(){return this.component.toString()}};d(Ct,"THISANDFUTURE","THISANDFUTURE");let Xt=Ct;function Ne(r,t){return r[0]>t[0]?1:t[0]>r[0]?-1:0}class vi{constructor(t){d(this,"parseEvent",!0);d(this,"parseTimezone",!0);d(this,"oncomplete",function(){});d(this,"onerror",function(t){});d(this,"ontimezone",function(t){});d(this,"onevent",function(t){});typeof t>"u"&&(t={});for(let[e,i]of Object.entries(t))this[e]=i}process(t){typeof t=="string"&&(t=N(t)),t instanceof X||(t=new X(t));let e=t.getAllSubcomponents(),i=0,s=e.length,n;for(;i<s;i++)switch(n=e[i],n.name){case"vtimezone":if(this.parseTimezone){let a=n.getFirstPropertyValue("tzid");a&&this.ontimezone(new I({tzid:a,component:n}))}break;case"vevent":this.parseEvent&&this.onevent(new Xt(n));break;default:continue}this.oncomplete()}}var mt={foldLength:75,debug:!1,newLineChar:`\r
`,Binary:Gt,Component:X,ComponentParser:vi,Duration:W,Event:Xt,Period:dt,Property:Dt,Recur:j,RecurExpansion:Me,RecurIterator:Lt,Time:g,Timezone:I,TimezoneService:Jt,UtcOffset:Q,VCardTime:ft,parse:N,stringify:M,design:k,helpers:hi};async function bi(r){const e=await(await fetch(r)).text(),i=mt.parse(e);return new mt.Component(i).getAllSubcomponents("vevent").map(a=>({summary:a.getFirstPropertyValue("summary"),startDate:a.getFirstPropertyValue("dtstart"),endDate:a.getFirstPropertyValue("dtend")}))}var xi=nt('<span class="self-center whitespace-nowrap text-xl font-semibold dark:text-blue-500 svelte-3vn2lb">Concierge</span>'),Ni=nt('<!> <input type="text" placeholder="Enter iCal URL" class="svelte-3vn2lb"> <button class="svelte-3vn2lb">Load Calendar from URL</button> OR <input type="file" accept=".ics" class="svelte-3vn2lb">',1),Si=nt('<div class="time-slot svelte-3vn2lb"> </div>'),Ii=nt('<div class="time-slot svelte-3vn2lb"> </div>'),Ci=nt('<div class="event-controls top-controls svelte-3vn2lb"><button class="svelte-3vn2lb">&uarr;</button> <button class="svelte-3vn2lb">&darr;</button></div>'),Mi=nt('<div class="event-controls bottom-controls svelte-3vn2lb"><button class="svelte-3vn2lb">Cancel</button> <button class="svelte-3vn2lb">OK</button></div>'),Li=nt('<div><div class="top svelte-3vn2lb"><div class="event-time svelte-3vn2lb"> </div> <!></div> <div class="event-summary svelte-3vn2lb"> </div> <!></div>'),Bi=nt('<div class="calendar-grid svelte-3vn2lb"><div class="time-column mobile-only svelte-3vn2lb"></div> <div class="day-column svelte-3vn2lb"><h3 class="day-header svelte-3vn2lb"> </h3> <div class="events-column svelte-3vn2lb"></div></div></div>'),Pi=nt('<!> <div class="calendar-container svelte-3vn2lb"><div class="calendar-scroll-wrapper svelte-3vn2lb"><div class="time-column desktop-only svelte-3vn2lb"></div> <div class="calendar-wrapper svelte-3vn2lb"></div></div></div>',1);function Ji(r,t){Ve(t,!1);let e=[],i=pe(""),s=pe([]);qe(()=>{const Y=localStorage.getItem("calendarDays");if(Y){const D=JSON.parse(Y).map(_=>({..._,events:_.events.map(E=>({...E,startDate:E.startDate?new Date(E.startDate):null,endDate:E.endDate?new Date(E.endDate):null}))}));At(s,[...D])}});function n(Y){Y.forEach(D=>{var F;if(D.events.length===0)return;D.events.sort((b,x)=>{var L,H;return(((L=b.startDate)==null?void 0:L.getTime())||0)-(((H=x.startDate)==null?void 0:H.getTime())||0)});const _=D.events[0],E=D.events[D.events.length-1];if(_.startDate&&_.startDate.getHours()>=8){const b=new Date(_.startDate);b.setHours(b.getHours()-1),b.getHours()<23&&b.getDate()===_.startDate.getDate()&&D.events.push({id:`wake-up-${_.id}`,summary:"Wake-Up",startDate:b,endDate:new Date(b.getTime()+30*6e4),isSuggested:!0})}let C=new Date(_.startDate);C.setHours(12,0,0,0);const B=D.events.find(b=>b.startDate&&b.startDate.getHours()>=13);B&&(C=new Date(B.startDate.getTime()-60*6e4));const tt=new Date(C.getTime()+60*6e4);if(B&&tt>new Date(B.startDate.getTime()-30*6e4)&&(C=new Date(B.startDate.getTime()-90*6e4),tt.setTime(C.getTime()+60*6e4)),C.getHours()<23&&C.getDate()===_.startDate.getDate()&&D.events.push({id:`lunch-${_.id}`,summary:"Lunch",startDate:C,endDate:tt,isSuggested:!0}),D.events.forEach(b=>{var x,L;if(((x=b.summary)!=null&&x.toLowerCase().includes("meeting")||(L=b.summary)!=null&&L.toLowerCase().includes("conference"))&&b.startDate){const H=new Date(b.startDate);H.setMinutes(H.getMinutes()-30),H.getHours()<23&&H.getDate()===b.startDate.getDate()&&D.events.push({id:`transfer-${b.id}`,summary:"Transfer to Event Location",startDate:H,endDate:new Date(H.getTime()+30*6e4),isSuggested:!0})}}),E.endDate||E.startDate){const b=new Date(E.endDate||E.startDate);b.setMinutes(b.getMinutes()+30);const x=new Date(b.getTime()+60*6e4);b.getHours()<23&&x.getHours()<23&&x.getDate()===b.getDate()&&D.events.push({id:`spa-${E.id}`,summary:"Relaxing Spa Session",startDate:b,endDate:x,isSuggested:!0});const L=new Date(b.getTime()+90*6e4),H=new Date(L.getTime()+120*6e4);L.getHours()<23&&H.getHours()<23&&L.getDate()===((F=E.startDate)==null?void 0:F.getDate())&&D.events.push({id:`dinner-${E.id}`,summary:"Dinner Reservation",startDate:L,endDate:H,isSuggested:!0})}})}function a(Y){if(!Y.startDate)return 1;const D=Y.startDate.getHours(),_=Y.startDate.getMinutes(),E=Math.floor((D-6)*2+_/30);return E>=1&&E<=34?E:-1}function l(Y){if(!Y.startDate||!Y.endDate)return 1;const D=Y.endDate.getHours()-Y.startDate.getHours(),_=Y.endDate.getMinutes()-Y.startDate.getMinutes();return Math.max(Math.ceil(D*2+_/30),1)}function o(Y,D,_){if(!Y.isSuggested)return;const E=new Date(Y.startDate),C=new Date(Y.endDate);E.setMinutes(E.getMinutes()+D*30),C.setMinutes(C.getMinutes()+D*30),_.events=_.events.map(B=>B.id===Y.id?{...B,startDate:E,endDate:C}:B),At(s,[...w(s)]),console.log("adjustEventTime:",_.events),T()}function u(Y,D){D.events=D.events.map(E=>E.id===Y.id?{...E,confirmed:!0}:E),At(s,[...w(s)]);const _=document.querySelector(`#confirm-btn-${Y.id}`);_&&(_.classList.add("ok-button-animated"),setTimeout(()=>{_.textContent=""},500)),console.log("confirmEvent:",D.events),S()}function h(Y,D){D.events=D.events.filter(_=>_.id!==Y.id),At(s,[...w(s)]),console.log("cancelEvent:",D.events)}async function c(){if(w(i))try{const D=(await bi(w(i))).map((_,E)=>({id:`url-event-${E}`,summary:typeof _.summary=="string"?_.summary:null,startDate:typeof _.startDate=="string"||_.startDate instanceof Date?new Date(_.startDate):null,endDate:typeof _.endDate=="string"||_.endDate instanceof Date?new Date(_.endDate):null,isInitial:!0}));A(D)}catch(Y){console.error("Failed to fetch calendar data:",Y)}}async function f(Y){var E;const _=(E=Y.target.files)==null?void 0:E[0];if(_){const C=await _.text();y(C)}}function y(Y){const D=mt.parse(Y),C=new mt.Component(D).getAllSubcomponents("vevent").map((B,tt)=>{const F=new mt.Event(B);return{id:`file-event-${tt}`,summary:F.summary||"No Title",startDate:F.startDate?F.startDate.toJSDate():null,endDate:F.endDate?F.endDate.toJSDate():null}});A(C)}function A(Y){e=Y,p(),n(w(s)),T()}function p(){const Y={};e.forEach(D=>{const _=D.startDate?D.startDate.toDateString():"Unknown Date";Y[_]||(Y[_]=[]),Y[_].push(D)}),At(s,Object.entries(Y).map(([D,_])=>({date:D,events:_}))),T()}function T(){localStorage.setItem("calendarDays",JSON.stringify(w(s)))}async function S(){const Y=localStorage.getItem("calendarDays");if(!Y){console.log("No data in local storage to push.");return}const D=JSON.parse(Y);try{const{data:_,error:E}=await Xe.from("calendar_days").insert(D);E?console.error("Error pushing data to Supabase:",E):console.log("Data pushed to Supabase successfully:",_)}catch(_){console.error("Unexpected error:",_)}}Fe();var at=Pi(),lt=me(at);$e(lt,{class:"start-0 top-0 z-20 w-full justify-center space-x-4 border-b px-5 py-3.5 sm:px-4 flex flex-col",children:(Y,D)=>{var _=Ni(),E=me(_);Qe(E,{href:"/",children:(F,b)=>{var x=xi();et(F,x)},$$slots:{default:!0}});var C=G(E,2);Ze(C);var B=G(C,2),tt=G(B,2);Ge(C,()=>w(i),F=>At(i,F)),wt("click",B,c),wt("change",tt,f),et(Y,_)},$$slots:{default:!0}});var ue=G(lt,2),he=Z(ue),$t=Z(he);Ut($t,4,()=>Array.from({length:18},(Y,D)=>6+D),Ht,(Y,D)=>{var _=Si(),E=Z(_);z(_),Et(()=>It(E,`${D??""}:00`)),et(Y,_)}),z($t);var ce=G($t,2);Ut(ce,5,()=>w(s),Ht,(Y,D)=>{var _=Bi(),E=Z(_);Ut(E,4,()=>Array.from({length:18},(b,x)=>6+x),Ht,(b,x)=>{var L=Ii(),H=Z(L);z(L),Et(()=>It(H,`${x??""}:00`)),et(b,L)}),z(E);var C=G(E,2),B=Z(C),tt=Z(B,!0);Et(()=>It(tt,new Date(w(D).date).toLocaleDateString("default",{day:"numeric",month:"short"}))),z(B);var F=G(B,2);Ut(F,5,()=>w(D).events,Ht,(b,x)=>{var L=Li();const H=St(()=>a(w(x))??""),Le=St(()=>l(w(x))??""),Be=St(()=>`
									grid-row-start: ${w(H)};
									grid-row-end: span ${w(Le)};
									`);var Qt=Z(L),te=Z(Qt);const Pe=St(()=>(w(x).startDate?w(x).startDate.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A")??""),ke=St(()=>(w(x).endDate?w(x).endDate.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"N/A")??"");var ze=Z(te);Et(()=>It(ze,`${w(Pe)} -
											${w(ke)}`)),z(te);var Ue=G(te,2);ye(Ue,()=>w(x).isSuggested,ie=>{var pt=Ci(),Nt=Z(pt),Pt=G(Nt,2);z(pt),wt("click",Nt,()=>o(w(x),-1,w(D))),wt("click",Pt,()=>o(w(x),1,w(D))),et(ie,pt)}),z(Qt);var ee=G(Qt,2),He=Z(ee,!0);z(ee);var Re=G(ee,2);ye(Re,()=>w(x).isSuggested,ie=>{var pt=Mi(),Nt=Z(pt),Pt=G(Nt,2);z(pt),Et(()=>_e(Pt,"id",`confirm-btn-${w(x).id??""}`)),wt("click",Nt,()=>h(w(x),w(D))),wt("click",Pt,()=>u(w(x),w(D))),et(ie,pt)}),z(L),Et(()=>{Je(L,`event-item ${(w(x).confirmed?"accepted":w(x).isSuggested?"suggested":w(x).isInitial?"initial":"")??""} svelte-3vn2lb`),_e(L,"style",w(Be)),It(He,w(x).summary)}),et(b,L)}),z(F),z(C),z(_),et(Y,_)}),z(ce),z(he),z(ue),et(r,at),Ke()}export{Ji as component};
